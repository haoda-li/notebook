<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Haoda Li"><link rel=prev href=llama.html><link rel=next href=../cs284/sampling.html><link rel=icon href=../assets/logo.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.48"><title>AWS Trainium and NKI kernel - Notebook</title><link rel=stylesheet href=../assets/stylesheets/main.6f8fc17f.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css><link rel=stylesheet href=../assets/extra.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=green data-md-color-accent=deep-purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#aws-trainium-and-nki-kernel class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../index.html title=Notebook class="md-header__button md-logo" aria-label=Notebook data-md-component=logo> <img src=../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Notebook </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> AWS Trainium and NKI kernel </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=green data-md-color-accent=deep-purple aria-label="Dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=deep-purple data-md-color-accent=green aria-label="Light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/haoda-li/notebook title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../index.html class=md-tabs__link> Courses </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../cs294173/intro.html class=md-tabs__link> Research Notes </a> </li> <li class=md-tabs__item> <a href=../cs284/sampling.html class=md-tabs__link> CS - VCCG </a> </li> <li class=md-tabs__item> <a href=../csc412/models.html class=md-tabs__link> CS - AIML </a> </li> <li class=md-tabs__item> <a href=../csc488/intro.md class=md-tabs__link> CS - General </a> </li> <li class=md-tabs__item> <a href=../mat337/real_number_construction.html class=md-tabs__link> Mathematics </a> </li> <li class=md-tabs__item> <a href=../sta303/Summary.html class=md-tabs__link> Statistics </a> </li> <li class=md-tabs__item> <a href=https://haoda-li.github.io/ class=md-tabs__link> Main </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../index.html title=Notebook class="md-nav__button md-logo" aria-label=Notebook data-md-component=logo> <img src=../assets/logo.png alt=logo> </a> Notebook </label> <div class=md-nav__source> <a href=https://github.com/haoda-li/notebook title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../index.html class=md-nav__link> <span class=md-ellipsis> Courses </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Research Notes </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Research Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex=0> <span class=md-ellipsis> CS294-173 Learning for 3D Seminar </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> CS294-173 Learning for 3D Seminar </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cs294173/intro.html class=md-nav__link> <span class=md-ellipsis> Problem Formulations for 3D Vision </span> </a> </li> <li class=md-nav__item> <a href=../cs294173/optical_flow.html class=md-nav__link> <span class=md-ellipsis> Supervised Correspondence </span> </a> </li> <li class=md-nav__item> <a href=../cs294173/supervised3d.html class=md-nav__link> <span class=md-ellipsis> Single View 3D with Supervision </span> </a> </li> <li class=md-nav__item> <a href=../cs294173/pointcloud.html class=md-nav__link> <span class=md-ellipsis> Deep Learning for 3D Point Clouds </span> </a> </li> <li class=md-nav__item> <a href=../cs294173/nerf.html class=md-nav__link> <span class=md-ellipsis> Neural Radiance Fields </span> </a> </li> <li class=md-nav__item> <a href=../cs294173/shl.html class=md-nav__link> <span class=md-ellipsis> Spherical Harmonic Lighting </span> </a> </li> <li class=md-nav__item> <a href=../cs294173/sdf_nerf.html class=md-nav__link> <span class=md-ellipsis> Surface based Volume Rendering </span> </a> </li> <li class=md-nav__item> <a href=../cs294173/3dgaussian.html class=md-nav__link> <span class=md-ellipsis> Gaussian Splatting </span> </a> </li> <li class=md-nav__item> <a href=../cs294173/3dgsmath.html class=md-nav__link> <span class=md-ellipsis> 3DGS Implementation Details </span> </a> </li> <li class=md-nav__item> <a href=../cs294173/rotations.html class=md-nav__link> <span class=md-ellipsis> Pose Parameterization and Optimization </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=llama.html class=md-nav__link> <span class=md-ellipsis> LLM Basics </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> AWS Trainium and NKI kernel </span> <span class="md-nav__icon md-icon"></span> </label> <a href=trainium.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> AWS Trainium and NKI kernel </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#trainium-hardware-architecture class=md-nav__link> <span class=md-ellipsis> Trainium Hardware Architecture </span> </a> <nav class=md-nav aria-label="Trainium Hardware Architecture"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#systolic-arrays class=md-nav__link> <span class=md-ellipsis> Systolic Arrays </span> </a> </li> <li class=md-nav__item> <a href=#psum-constraints class=md-nav__link> <span class=md-ellipsis> PSUM Constraints </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#nki-neuron-kernel-interface class=md-nav__link> <span class=md-ellipsis> NKI (Neuron Kernel Interface) </span> </a> </li> <li class=md-nav__item> <a href=#data-tiling class=md-nav__link> <span class=md-ellipsis> Data Tiling </span> </a> <nav class=md-nav aria-label="Data Tiling"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#partition-dimension class=md-nav__link> <span class=md-ellipsis> Partition Dimension </span> </a> </li> <li class=md-nav__item> <a href=#free-dimension class=md-nav__link> <span class=md-ellipsis> Free Dimension </span> </a> </li> <li class=md-nav__item> <a href=#data-movement-and-computation class=md-nav__link> <span class=md-ellipsis> Data Movement and Computation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#tensor-engine-matrix-multiplication class=md-nav__link> <span class=md-ellipsis> Tensor Engine: Matrix Multiplication </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> CS - VCCG </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> CS - VCCG </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex=0> <span class=md-ellipsis> CS284A Computer Graphics and Imaging </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> CS284A Computer Graphics and Imaging </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cs284/sampling.html class=md-nav__link> <span class=md-ellipsis> Sampling Theory </span> </a> </li> <li class=md-nav__item> <a href=../cs284/transforms.html class=md-nav__link> <span class=md-ellipsis> 3D Transformations </span> </a> </li> <li class=md-nav__item> <a href=../cs284/texture.html class=md-nav__link> <span class=md-ellipsis> Texture Mapping </span> </a> </li> <li class=md-nav__item> <a href=../cs284/splines.html class=md-nav__link> <span class=md-ellipsis> Splines </span> </a> </li> <li class=md-nav__item> <a href=../cs284/mesh.html class=md-nav__link> <span class=md-ellipsis> Mesh Representations </span> </a> </li> <li class=md-nav__item> <a href=../cs284/raytracing.html class=md-nav__link> <span class=md-ellipsis> Ray Tracing and Acceleration Data Structure </span> </a> </li> <li class=md-nav__item> <a href=../cs284/mcintegral.html class=md-nav__link> <span class=md-ellipsis> Monte Carlo Integration </span> </a> </li> <li class=md-nav__item> <a href=../cs284/pathtracing.html class=md-nav__link> <span class=md-ellipsis> Global Illumination and Path Tracing </span> </a> </li> <li class=md-nav__item> <a href=../cs284/camera.html class=md-nav__link> <span class=md-ellipsis> Cameras </span> </a> </li> <li class=md-nav__item> <a href=../cs284/kinematics.html class=md-nav__link> <span class=md-ellipsis> Animation through Kinematics </span> </a> </li> <li class=md-nav__item> <a href=../cs284/simulation.html class=md-nav__link> <span class=md-ellipsis> Physics based Animation </span> </a> </li> <li class=md-nav__item> <a href=../cs284/fluids.html class=md-nav__link> <span class=md-ellipsis> Fluid Simulation </span> </a> </li> <li class=md-nav__item> <a href=../cs284/color.html class=md-nav__link> <span class=md-ellipsis> Color Sciences </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> CSC418 Computer Graphics </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> CSC418 Computer Graphics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../csc418/raster_image.html class=md-nav__link> <span class=md-ellipsis> Raster Image </span> </a> </li> <li class=md-nav__item> <a href=../csc418/meshes.html class=md-nav__link> <span class=md-ellipsis> Meshes </span> </a> </li> <li class=md-nav__item> <a href=../csc418/bvh.html class=md-nav__link> <span class=md-ellipsis> Bounding Volume Hierarchy </span> </a> </li> <li class=md-nav__item> <a href=../csc418/shader_pipeline.html class=md-nav__link> <span class=md-ellipsis> Shader Pipeline </span> </a> </li> <li class=md-nav__item> <a href=../csc418/kinematics.html class=md-nav__link> <span class=md-ellipsis> Kinematics </span> </a> </li> <li class=md-nav__item> <a href=../csc418/mass_spring_system.html class=md-nav__link> <span class=md-ellipsis> Mass-Spring System </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> CSC417/2549 Physics-based Animation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> CSC417/2549 Physics-based Animation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../csc417/introduction.html class=md-nav__link> <span class=md-ellipsis> Math and Physics Background </span> </a> </li> <li class=md-nav__item> <a href=../csc417/1d_mass_spring.html class=md-nav__link> <span class=md-ellipsis> 1D Mass Spring System </span> </a> </li> <li class=md-nav__item> <a href=../csc417/3d_mass_spring_system.html class=md-nav__link> <span class=md-ellipsis> 3D Mass Spring System </span> </a> </li> <li class=md-nav__item> <a href=../csc417/fem.html class=md-nav__link> <span class=md-ellipsis> Finite Element Method </span> </a> </li> <li class=md-nav__item> <a href=../csc417/cloth.html class=md-nav__link> <span class=md-ellipsis> Cloth Simulation and Collision </span> </a> </li> <li class=md-nav__item> <a href=../csc417/rigid_bodies.html class=md-nav__link> <span class=md-ellipsis> Rigid Body Simulation </span> </a> </li> <li class=md-nav__item> <a href=../csc417/rotations.html class=md-nav__link> <span class=md-ellipsis> Rotation Matrix Time Derivatives </span> </a> </li> <li class=md-nav__item> <a href=../csc417/collision.html class=md-nav__link> <span class=md-ellipsis> Rigid body Collisions </span> </a> </li> <li class=md-nav__item> <a href=../csc417/fluids.html class=md-nav__link> <span class=md-ellipsis> Fluid Simulation using SPH and FLIP </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> CSC419/2520 Geometry Processing </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> CSC419/2520 Geometry Processing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../csc419/introduction.html class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../csc419/surface_reconstruction.html class=md-nav__link> <span class=md-ellipsis> Surface Reconstruction </span> </a> </li> <li class=md-nav__item> <a href=../csc419/registration.html class=md-nav__link> <span class=md-ellipsis> Registration </span> </a> </li> <li class=md-nav__item> <a href=../csc419/sparse_icp.html class=md-nav__link> <span class=md-ellipsis> Sparse Iterative Closest Point </span> </a> </li> <li class=md-nav__item> <a href=../csc419/smoothing.html class=md-nav__link> <span class=md-ellipsis> Surface Smoothing </span> </a> </li> <li class=md-nav__item> <a href=../csc419/deformation.html class=md-nav__link> <span class=md-ellipsis> Handle-based Deformation </span> </a> </li> <li class=md-nav__item> <a href=../csc419/parameterization.html class=md-nav__link> <span class=md-ellipsis> Parameterization </span> </a> </li> <li class=md-nav__item> <a href=../csc419/curvature.html class=md-nav__link> <span class=md-ellipsis> Curvature </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5 id=__nav_3_5_label tabindex=0> <span class=md-ellipsis> CSC320 Intro. Visual Computing </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> CSC320 Intro. Visual Computing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../csc320/camera.html class=md-nav__link> <span class=md-ellipsis> Camera </span> </a> </li> <li class=md-nav__item> <a href=../csc320/matting.html class=md-nav__link> <span class=md-ellipsis> Image Matting </span> </a> </li> <li class=md-nav__item> <a href=../csc320/hdr.html class=md-nav__link> <span class=md-ellipsis> High Dynamic Range </span> </a> </li> <li class=md-nav__item> <a href=../csc320/blending.html class=md-nav__link> <span class=md-ellipsis> Image Pyramids and Blending </span> </a> </li> <li class=md-nav__item> <a href=../csc320/poly_fitting.html class=md-nav__link> <span class=md-ellipsis> Polynomial Fitting </span> </a> </li> <li class=md-nav__item> <a href=../csc320/wavelet.html class=md-nav__link> <span class=md-ellipsis> Wavelet Transform </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6 id=__nav_3_6_label tabindex=0> <span class=md-ellipsis> CSC420 Intro. Image Understanding </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> CSC420 Intro. Image Understanding </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../csc420/linear_filters.html class=md-nav__link> <span class=md-ellipsis> Linear Filters </span> </a> </li> <li class=md-nav__item> <a href=../csc420/edge_detection.html class=md-nav__link> <span class=md-ellipsis> Edge Detection </span> </a> </li> <li class=md-nav__item> <a href=../csc420/image_pyramids.html class=md-nav__link> <span class=md-ellipsis> Image Pyramids </span> </a> </li> <li class=md-nav__item> <a href=../csc420/harris_corner_detector.html class=md-nav__link> <span class=md-ellipsis> Image Features - Harris Corner Detector </span> </a> </li> <li class=md-nav__item> <a href=../csc420/blob_detection.html class=md-nav__link> <span class=md-ellipsis> Image Features - Blob Detection </span> </a> </li> <li class=md-nav__item> <a href=../csc420/sift.html class=md-nav__link> <span class=md-ellipsis> Scale Invariant Feature Transform </span> </a> </li> <li class=md-nav__item> <a href=../csc420/camera_model.html class=md-nav__link> <span class=md-ellipsis> Homography - Basics and Camera Model </span> </a> </li> <li class=md-nav__item> <a href=../csc420/stereo.html class=md-nav__link> <span class=md-ellipsis> Homography - Stereo </span> </a> </li> <li class=md-nav__item> <a href=../csc420/indexing.html class=md-nav__link> <span class=md-ellipsis> Features Fast Retrival </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> CS - AIML </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> CS - AIML </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_1> <label class=md-nav__link for=__nav_4_1 id=__nav_4_1_label tabindex=0> <span class=md-ellipsis> CSC412/2506 Probabilistic Learning and Reasoning </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> CSC412/2506 Probabilistic Learning and Reasoning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../csc412/models.html class=md-nav__link> <span class=md-ellipsis> Probabilistic Models </span> </a> </li> <li class=md-nav__item> <a href=../csc412/dag.html class=md-nav__link> <span class=md-ellipsis> Joint distributions with Graphical models </span> </a> </li> <li class=md-nav__item> <a href=../csc412/inference.html class=md-nav__link> <span class=md-ellipsis> Exact Inference </span> </a> </li> <li class=md-nav__item> <a href=../csc412/mc.html class=md-nav__link> <span class=md-ellipsis> Hidden Markov Models </span> </a> </li> <li class=md-nav__item> <a href=../csc412/sampling.html class=md-nav__link> <span class=md-ellipsis> Sampling </span> </a> </li> <li class=md-nav__item> <a href=../csc412/vi.html class=md-nav__link> <span class=md-ellipsis> Variational Inference </span> </a> </li> <li class=md-nav__item> <a href=../csc412/vae.html class=md-nav__link> <span class=md-ellipsis> Variational Autoencoders </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex=0> <span class=md-ellipsis> CSC311 Intro. Machine Learning </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> CSC311 Intro. Machine Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../csc311/knn.html class=md-nav__link> <span class=md-ellipsis> k-Nearest Neighbors </span> </a> </li> <li class=md-nav__item> <a href=../csc311/bvd.html class=md-nav__link> <span class=md-ellipsis> Bias-Variane Decomposition </span> </a> </li> <li class=md-nav__item> <a href=../csc311/decision_trees.html class=md-nav__link> <span class=md-ellipsis> Decision Trees </span> </a> </li> <li class=md-nav__item> <a href=../csc311/linear_regression.html class=md-nav__link> <span class=md-ellipsis> Linear Regression </span> </a> </li> <li class=md-nav__item> <a href=../csc311/svm.html class=md-nav__link> <span class=md-ellipsis> Support Vector Machines and Boosting </span> </a> </li> <li class=md-nav__item> <a href=../csc311/neural_nets.html class=md-nav__link> <span class=md-ellipsis> Neural Networks </span> </a> </li> <li class=md-nav__item> <a href=../csc311/gradient_descent.html class=md-nav__link> <span class=md-ellipsis> Gradient Descent </span> </a> </li> <li class=md-nav__item> <a href=../csc311/classification.html class=md-nav__link> <span class=md-ellipsis> Classification Optimization </span> </a> </li> <li class=md-nav__item> <a href=../csc311/probabilistic_models.html class=md-nav__link> <span class=md-ellipsis> Probabilistic Models </span> </a> </li> <li class=md-nav__item> <a href=../csc311/pca.html class=md-nav__link> <span class=md-ellipsis> Dimension Reduction - PCA and Auto Encoders </span> </a> </li> <li class=md-nav__item> <a href=../csc311/kM_EM.html class=md-nav__link> <span class=md-ellipsis> k-Means and EM Algorithm </span> </a> </li> <li class=md-nav__item> <a href=../csc311/matrix_factorization.html class=md-nav__link> <span class=md-ellipsis> Matrix Factorization </span> </a> </li> <li class=md-nav__item> <a href=../csc311/reinforce_learning.html class=md-nav__link> <span class=md-ellipsis> Reinforcement Learning </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3 id=__nav_4_3_label tabindex=0> <span class=md-ellipsis> CSC384 Intro. Artificial Intelligence </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> CSC384 Intro. Artificial Intelligence </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../csc384/search.html class=md-nav__link> <span class=md-ellipsis> Search </span> </a> </li> <li class=md-nav__item> <a href=../csc384/usearch.html class=md-nav__link> <span class=md-ellipsis> Uninformed search </span> </a> </li> <li class=md-nav__item> <a href=../csc384/hsearch.html class=md-nav__link> <span class=md-ellipsis> Heuristic Search </span> </a> </li> <li class=md-nav__item> <a href=../csc384/csp.html class=md-nav__link> <span class=md-ellipsis> CSP Backtracking </span> </a> </li> <li class=md-nav__item> <a href=../csc384/fc_gac.html class=md-nav__link> <span class=md-ellipsis> Constraint Propagation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> CS - General </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> CS - General </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_1> <label class=md-nav__link for=__nav_5_1 id=__nav_5_1_label tabindex=0> <span class=md-ellipsis> CSC488/2107 Compilers </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_1_label aria-expanded=false> <label class=md-nav__title for=__nav_5_1> <span class="md-nav__icon md-icon"></span> CSC488/2107 Compilers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../csc488/intro.md class=md-nav__link> <span class=md-ellipsis> None </span> </a> </li> <li class=md-nav__item> <a href=../csc488/parsing.md class=md-nav__link> <span class=md-ellipsis> None </span> </a> </li> <li class=md-nav__item> <a href=../csc488/topdown_parsing.md class=md-nav__link> <span class=md-ellipsis> None </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> CS267C Applications of Parallel Computers </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> CS267C Applications of Parallel Computers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cs267/communication.html class=md-nav__link> <span class=md-ellipsis> Communication Optimal Matmul </span> </a> </li> <li class=md-nav__item> <a href=../cs267/distributed.html class=md-nav__link> <span class=md-ellipsis> Advanced MPI </span> </a> </li> <li class=md-nav__item> <a href=../cs267/dataparallel.html class=md-nav__link> <span class=md-ellipsis> Data Parallel Algorithms </span> </a> </li> <li class=md-nav__item> <a href=../cs267/la.html class=md-nav__link> <span class=md-ellipsis> Parallel Dense Linear Algebra </span> </a> </li> <li class=md-nav__item> <a href=../cs267/random.html class=md-nav__link> <span class=md-ellipsis> Randomized Algorithms </span> </a> </li> <li class=md-nav__item> <a href=../cs267/upcxx.html class=md-nav__link> <span class=md-ellipsis> UPC++ Introduction </span> </a> </li> <li class=md-nav__item> <a href=../cs267/ml.html class=md-nav__link> <span class=md-ellipsis> Parallel Machine Learning </span> </a> </li> <li class=md-nav__item> <a href=../cs267/grid.html class=md-nav__link> <span class=md-ellipsis> Structured Grid for Poisson's Equations </span> </a> </li> <li class=md-nav__item> <a href=../cs267/sparse_matrix.html class=md-nav__link> <span class=md-ellipsis> Sparse Matrices </span> </a> </li> <li class=md-nav__item> <a href=../cs267/fft.html class=md-nav__link> <span class=md-ellipsis> Fast Fourier Transform </span> </a> </li> <li class=md-nav__item> <a href=../cs267/sort.html class=md-nav__link> <span class=md-ellipsis> Parallel Searching and Sorting </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_3> <label class=md-nav__link for=__nav_5_3 id=__nav_5_3_label tabindex=0> <span class=md-ellipsis> CSC367 Parallel Programming </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> CSC367 Parallel Programming </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../csc367/hie.html class=md-nav__link> <span class=md-ellipsis> Single Processor Machines </span> </a> </li> <li class=md-nav__item> <a href=../csc367/matrix.html class=md-nav__link> <span class=md-ellipsis> Single Processor Matrix Multiplications </span> </a> </li> <li class=md-nav__item> <a href=../csc367/simd.html class=md-nav__link> <span class=md-ellipsis> SIMD Parallelism </span> </a> </li> <li class=md-nav__item> <a href=../csc367/parallel.html class=md-nav__link> <span class=md-ellipsis> Parallel Algorithm Design </span> </a> </li> <li class=md-nav__item> <a href=../csc367/pthread.html class=md-nav__link> <span class=md-ellipsis> Shared Memory Model with PThread </span> </a> </li> <li class=md-nav__item> <a href=../csc367/omp.html class=md-nav__link> <span class=md-ellipsis> OpenMP - Introduction of Parallelism </span> </a> </li> <li class=md-nav__item> <a href=../csc367/omp_for.html class=md-nav__link> <span class=md-ellipsis> OpenMP - For Loop, Sections, Tasks </span> </a> </li> <li class=md-nav__item> <a href=../csc367/omp_sync.html class=md-nav__link> <span class=md-ellipsis> OpenMP - Synchronizations and Performance Profiling </span> </a> </li> <li class=md-nav__item> <a href=../csc367/mpi.html class=md-nav__link> <span class=md-ellipsis> Distributed Memory Model and MPI Introduction </span> </a> </li> <li class=md-nav__item> <a href=../csc367/mpi_comm.html class=md-nav__link> <span class=md-ellipsis> MPI Communications </span> </a> </li> <li class=md-nav__item> <a href=../csc367/cuda.html class=md-nav__link> <span class=md-ellipsis> CUDA Programming - Basics </span> </a> </li> <li class=md-nav__item> <a href=../csc367/cuda_opt.html class=md-nav__link> <span class=md-ellipsis> CUDA Programming - Parallel Reduction </span> </a> </li> <li class=md-nav__item> <a href=../csc367/slurm.html class=md-nav__link> <span class=md-ellipsis> SLURM Job Scheduling </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_4> <label class=md-nav__link for=__nav_5_4 id=__nav_5_4_label tabindex=0> <span class=md-ellipsis> CSC336 Numerical Methods </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> CSC336 Numerical Methods </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../csc336/approx_error.html class=md-nav__link> <span class=md-ellipsis> Approxmation Errors and Conditioning, Stability </span> </a> </li> <li class=md-nav__item> <a href=../csc336/arithmetic.html class=md-nav__link> <span class=md-ellipsis> Computer Arithmetic </span> </a> </li> <li class=md-nav__item> <a href=../csc336/arithmetic_examples.html class=md-nav__link> <span class=md-ellipsis> Computer Arithmetic Examples </span> </a> </li> <li class=md-nav__item> <a href=../csc336/norm.html class=md-nav__link> <span class=md-ellipsis> Norms of vectors and matrices </span> </a> </li> <li class=md-nav__item> <a href=../csc336/matrix_conditioning.html class=md-nav__link> <span class=md-ellipsis> Conditioning of Linear Equation Systems </span> </a> </li> <li class=md-nav__item> <a href=../csc336/lu_decomposition.html class=md-nav__link> <span class=md-ellipsis> LU Decomposition </span> </a> </li> <li class=md-nav__item> <a href=../csc336/pivoting.html class=md-nav__link> <span class=md-ellipsis> Pivoting </span> </a> </li> <li class=md-nav__item> <a href=../csc336/interpolations.html class=md-nav__link> <span class=md-ellipsis> Interpolations </span> </a> </li> <li class=md-nav__item> <a href=../csc336/non_linear_equations.html class=md-nav__link> <span class=md-ellipsis> Solve Non-linear equations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_5> <label class=md-nav__link for=__nav_5_5 id=__nav_5_5_label tabindex=0> <span class=md-ellipsis> CSC343 Intro. Databases </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5_5> <span class="md-nav__icon md-icon"></span> CSC343 Intro. Databases </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../csc343/ra.html class=md-nav__link> <span class=md-ellipsis> Relational Algebra </span> </a> </li> <li class=md-nav__item> <a href=../csc343/sql_query.html class=md-nav__link> <span class=md-ellipsis> SQL Query Syntax </span> </a> </li> <li class=md-nav__item> <a href=../csc343/sql_def.html class=md-nav__link> <span class=md-ellipsis> SQL Definitions Syntax </span> </a> </li> <li class=md-nav__item> <a href=../csc343/sql_man.html class=md-nav__link> <span class=md-ellipsis> SQL Data Manipulation Syntax </span> </a> </li> <li class=md-nav__item> <a href=../csc343/rm.html class=md-nav__link> <span class=md-ellipsis> Relational Model </span> </a> </li> <li class=md-nav__item> <a href=../csc343/fd.html class=md-nav__link> <span class=md-ellipsis> Functional Dependency </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_6> <label class=md-nav__link for=__nav_5_6 id=__nav_5_6_label tabindex=0> <span class=md-ellipsis> CSC373 Algorithms Design, Analysis and Complexity </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_6_label aria-expanded=false> <label class=md-nav__title for=__nav_5_6> <span class="md-nav__icon md-icon"></span> CSC373 Algorithms Design, Analysis and Complexity </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../csc373/greedy_algorithm.html class=md-nav__link> <span class=md-ellipsis> Greedy Algorithm </span> </a> </li> <li class=md-nav__item> <a href=../csc373/dp.html class=md-nav__link> <span class=md-ellipsis> Dynamic Programming </span> </a> </li> <li class=md-nav__item> <a href=../csc373/network_flow.html class=md-nav__link> <span class=md-ellipsis> Network Flow </span> </a> </li> <li class=md-nav__item> <a href=../csc373/lp.html class=md-nav__link> <span class=md-ellipsis> Linear Programming </span> </a> </li> <li class=md-nav__item> <a href=../csc373/p_np.html class=md-nav__link> <span class=md-ellipsis> P-NP Problem </span> </a> </li> <li class=md-nav__item> <a href=../csc373/npc.html class=md-nav__link> <span class=md-ellipsis> NP-complete </span> </a> </li> <li class=md-nav__item> <a href=../csc373/self_reducibility.html class=md-nav__link> <span class=md-ellipsis> Self Reducibility </span> </a> </li> <li class=md-nav__item> <a href=../csc373/optimization_approximation.html class=md-nav__link> <span class=md-ellipsis> Optimization Approxiamation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_7> <label class=md-nav__link for=__nav_5_7 id=__nav_5_7_label tabindex=0> <span class=md-ellipsis> CSC265 Enriched Data Structures and Analysis </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_7_label aria-expanded=false> <label class=md-nav__title for=__nav_5_7> <span class="md-nav__icon md-icon"></span> CSC265 Enriched Data Structures and Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../csc265/pq.html class=md-nav__link> <span class=md-ellipsis> Priority Queue: Max Heap </span> </a> </li> <li class=md-nav__item> <a href=../csc265/mq.html class=md-nav__link> <span class=md-ellipsis> [+] Priority Queue: Mergeable Heap </span> </a> </li> <li class=md-nav__item> <a href=../csc265/avl.html class=md-nav__link> <span class=md-ellipsis> Set: AVL Tree </span> </a> </li> <li class=md-nav__item> <a href=../csc265/avl_app.html class=md-nav__link> <span class=md-ellipsis> [+] Augmented BST (AVL Tree) </span> </a> </li> <li class=md-nav__item> <a href=../csc265/hashset.html class=md-nav__link> <span class=md-ellipsis> Set: Hash Tables </span> </a> </li> <li class=md-nav__item> <a href=../csc265/random.html class=md-nav__link> <span class=md-ellipsis> Randomized QuickSort </span> </a> </li> <li class=md-nav__item> <a href=../csc265/amortized.html class=md-nav__link> <span class=md-ellipsis> Amortized Analysis </span> </a> </li> <li class=md-nav__item> <a href=../csc265/disjoint_set.html class=md-nav__link> <span class=md-ellipsis> Disjoint Set </span> </a> </li> <li class=md-nav__item> <a href=../csc265/bfs.html class=md-nav__link> <span class=md-ellipsis> Graphs: Breadth-first Search </span> </a> </li> <li class=md-nav__item> <a href=../csc265/dfs.html class=md-nav__link> <span class=md-ellipsis> Graphs: Depth-first Search </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Mathematics </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Mathematics </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1> <label class=md-nav__link for=__nav_6_1 id=__nav_6_1_label tabindex=0> <span class=md-ellipsis> MAT337 Intro. Real Analysis </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_1_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1> <span class="md-nav__icon md-icon"></span> MAT337 Intro. Real Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../mat337/real_number_construction.html class=md-nav__link> <span class=md-ellipsis> Real Number Construction </span> </a> </li> <li class=md-nav__item> <a href=../mat337/extremum.html class=md-nav__link> <span class=md-ellipsis> Extremum </span> </a> </li> <li class=md-nav__item> <a href=../mat337/mct_bwt.html class=md-nav__link> <span class=md-ellipsis> MCT and BWT </span> </a> </li> <li class=md-nav__item> <a href=../mat337/topology_reals.html class=md-nav__link> <span class=md-ellipsis> Topology of real number space </span> </a> </li> <li class=md-nav__item> <a href=../mat337/normed_space.html class=md-nav__link> <span class=md-ellipsis> Normed Space </span> </a> </li> <li class=md-nav__item> <a href=../mat337/inner_product_and_fourier.html class=md-nav__link> <span class=md-ellipsis> Inner Product Space and Fourier Series </span> </a> </li> <li class=md-nav__item> <a href=../mat337/function_convergence.html class=md-nav__link> <span class=md-ellipsis> Functions Convergence </span> </a> </li> <li class=md-nav__item> <a href=../mat337/series.html class=md-nav__link> <span class=md-ellipsis> Series </span> </a> </li> <li class=md-nav__item> <a href=../mat337/AAT.html class=md-nav__link> <span class=md-ellipsis> Arzela-Ascoli Theorem </span> </a> </li> <li class=md-nav__item> <a href=../mat337/approximations.html class=md-nav__link> <span class=md-ellipsis> Function Approximations </span> </a> </li> <li class=md-nav__item> <a href=../mat337/ODE.html class=md-nav__link> <span class=md-ellipsis> Fixed Point and ODE </span> </a> </li> <li class=md-nav__item> <a href=../mat337/swt.html class=md-nav__link> <span class=md-ellipsis> Extra. Stone Weierstrass Theorem </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_2> <label class=md-nav__link for=__nav_6_2 id=__nav_6_2_label tabindex=0> <span class=md-ellipsis> MAT334 Complex Variables </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_2> <span class="md-nav__icon md-icon"></span> MAT334 Complex Variables </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../mat334/intro.html class=md-nav__link> <span class=md-ellipsis> Introducing Complex Numbers </span> </a> </li> <li class=md-nav__item> <a href=../mat334/functions.html class=md-nav__link> <span class=md-ellipsis> Elementary Functions </span> </a> </li> <li class=md-nav__item> <a href=../mat334/cont_diff.html class=md-nav__link> <span class=md-ellipsis> Limit, Continuity, and Differentiability </span> </a> </li> <li class=md-nav__item> <a href=../mat334/multi_val_func.html class=md-nav__link> <span class=md-ellipsis> Multivalued Functions </span> </a> </li> <li class=md-nav__item> <a href=../mat334/integration.html class=md-nav__link> <span class=md-ellipsis> Complex Integration </span> </a> </li> <li class=md-nav__item> <a href=../mat334/ct.html class=md-nav__link> <span class=md-ellipsis> Cauchy's Theorem </span> </a> </li> <li class=md-nav__item> <a href=../mat334/cie.html class=md-nav__link> <span class=md-ellipsis> Cauchy's Integral Formula </span> </a> </li> <li class=md-nav__item> <a href=../mat334/power_series.html class=md-nav__link> <span class=md-ellipsis> Power Series and Larent Series </span> </a> </li> <li class=md-nav__item> <a href=../mat334/residue.html class=md-nav__link> <span class=md-ellipsis> Sigularities and Residue Theorem </span> </a> </li> <li class=md-nav__item> <a href=../mat334/jl.html class=md-nav__link> <span class=md-ellipsis> Jordon's Lemma </span> </a> </li> <li class=md-nav__item> <a href=../mat334/pvt.html class=md-nav__link> <span class=md-ellipsis> Principal Value Integrals </span> </a> </li> <li class=md-nav__item> <a href=../mat334/arg.html class=md-nav__link> <span class=md-ellipsis> Argument Principle and Rouche's Theorem </span> </a> </li> <li class=md-nav__item> <a href=../mat334/conformal.html class=md-nav__link> <span class=md-ellipsis> Conformal Map and Mobius Transformation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_3> <label class=md-nav__link for=__nav_6_3 id=__nav_6_3_label tabindex=0> <span class=md-ellipsis> MAT363 Geometry of Curves and Surfaces </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_3> <span class="md-nav__icon md-icon"></span> MAT363 Geometry of Curves and Surfaces </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../mat363/intro_curves.html class=md-nav__link> <span class=md-ellipsis> Introduction to Curves </span> </a> </li> <li class=md-nav__item> <a href=../mat363/arc_length.html class=md-nav__link> <span class=md-ellipsis> Arc Length </span> </a> </li> <li class=md-nav__item> <a href=../mat363/reparam.html class=md-nav__link> <span class=md-ellipsis> Reparameterization and unit-length curve </span> </a> </li> <li class=md-nav__item> <a href=../mat363/curvature.html class=md-nav__link> <span class=md-ellipsis> Curvature </span> </a> </li> <li class=md-nav__item> <a href=../mat363/plane_curve.html class=md-nav__link> <span class=md-ellipsis> Plane Curve </span> </a> </li> <li class=md-nav__item> <a href=../mat363/space_curves.html class=md-nav__link> <span class=md-ellipsis> Space Curves </span> </a> </li> <li class=md-nav__item> <a href=../mat363/fvt.html class=md-nav__link> <span class=md-ellipsis> Four Vertex Theorem </span> </a> </li> <li class=md-nav__item> <a href=../mat363/iso_ineq.html class=md-nav__link> <span class=md-ellipsis> Isoperimetric Inequality </span> </a> </li> <li class=md-nav__item> <a href=../mat363/intro_surface.html class=md-nav__link> <span class=md-ellipsis> Defining Surfaces </span> </a> </li> <li class=md-nav__item> <a href=../mat363/surface_tangent.html class=md-nav__link> <span class=md-ellipsis> Surface Tangents and Derivatives </span> </a> </li> <li class=md-nav__item> <a href=../mat363/surface_normals.html class=md-nav__link> <span class=md-ellipsis> Surface Normals and Orientability </span> </a> </li> <li class=md-nav__item> <a href=../mat363/surface_examples.html class=md-nav__link> <span class=md-ellipsis> Examples of Surfaces </span> </a> </li> <li class=md-nav__item> <a href=../mat363/examples_smooth.html class=md-nav__link> <span class=md-ellipsis> More Examples of Surface Regularity and Smoothness </span> </a> </li> <li class=md-nav__item> <a href=../mat363/fff.html class=md-nav__link> <span class=md-ellipsis> First Fundamental Form </span> </a> </li> <li class=md-nav__item> <a href=../mat363/isometry.html class=md-nav__link> <span class=md-ellipsis> Isometric, Conformal, Equiareal </span> </a> </li> <li class=md-nav__item> <a href=../mat363/sff.html class=md-nav__link> <span class=md-ellipsis> Surface Curvatures </span> </a> </li> <li class=md-nav__item> <a href=../mat363/gaussian_curvature.html class=md-nav__link> <span class=md-ellipsis> Gaussian Curvatures </span> </a> </li> <li class=md-nav__item> <a href=../mat363/parallel_transport.html class=md-nav__link> <span class=md-ellipsis> Parallel Transport </span> </a> </li> <li class=md-nav__item> <a href=../mat363/geodesics.html class=md-nav__link> <span class=md-ellipsis> Geodesics </span> </a> </li> <li class=md-nav__item> <a href=../mat363/gcme.html class=md-nav__link> <span class=md-ellipsis> Gauss' Remarkable Theorem </span> </a> </li> <li class=md-nav__item> <a href=../mat363/minimal_surface.html class=md-nav__link> <span class=md-ellipsis> Minimal Surfaces </span> </a> </li> <li class=md-nav__item> <a href=../mat363/gbt.html class=md-nav__link> <span class=md-ellipsis> Gauss Bonnet Theorem </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_4> <label class=md-nav__link for=__nav_6_4 id=__nav_6_4_label tabindex=0> <span class=md-ellipsis> APM462 Nonlinear Optimization </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_4_label aria-expanded=false> <label class=md-nav__title for=__nav_6_4> <span class="md-nav__icon md-icon"></span> APM462 Nonlinear Optimization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../apm462/calculus_review.html class=md-nav__link> <span class=md-ellipsis> Calculus Review </span> </a> </li> <li class=md-nav__item> <a href=../apm462/ufdo.html class=md-nav__link> <span class=md-ellipsis> Unconstrained Finite Dimensional Optimization </span> </a> </li> <li class=md-nav__item> <a href=../apm462/ufdoq.html class=md-nav__link> <span class=md-ellipsis> Examples: Unconstrained Finite Dimensional Optimization </span> </a> </li> <li class=md-nav__item> <a href=../apm462/ecfdo.html class=md-nav__link> <span class=md-ellipsis> Equality Constrained Finite Dimension Optimization </span> </a> </li> <li class=md-nav__item> <a href=../apm462/ecfdoq.html class=md-nav__link> <span class=md-ellipsis> Examples: Equality Constrained Finite Dimension Optimization </span> </a> </li> <li class=md-nav__item> <a href=../apm462/icfdo.html class=md-nav__link> <span class=md-ellipsis> Inequality Constrained Finite Dimension Optimization </span> </a> </li> <li class=md-nav__item> <a href=../apm462/icfdoq.html class=md-nav__link> <span class=md-ellipsis> Examples: Inequality Constrained Finite Dimension Optimization </span> </a> </li> <li class=md-nav__item> <a href=../apm462/newtons_method_and_steepest_descent.html class=md-nav__link> <span class=md-ellipsis> Newton's Method and Steepest Descent </span> </a> </li> <li class=md-nav__item> <a href=../apm462/conjugate.html class=md-nav__link> <span class=md-ellipsis> Conjugate Directions and Conjugate Gradients </span> </a> </li> <li class=md-nav__item> <a href=../apm462/conjugateq.html class=md-nav__link> <span class=md-ellipsis> Examples: Conjugate Directions and Conjugate Gradients </span> </a> </li> <li class=md-nav__item> <a href=../apm462/uo_functional.html class=md-nav__link> <span class=md-ellipsis> Unconstrainted Optimization on Calulus of Variations </span> </a> </li> <li class=md-nav__item> <a href=../apm462/uo_functional_q.html class=md-nav__link> <span class=md-ellipsis> Examples: Unconstrainted Optimization on Calulus of Variations </span> </a> </li> <li class=md-nav__item> <a href=../apm462/co_functional.html class=md-nav__link> <span class=md-ellipsis> Constrainted Optimization on Calulus of Variations </span> </a> </li> <li class=md-nav__item> <a href=../apm462/co_functional_q.html class=md-nav__link> <span class=md-ellipsis> Examples: Constrainted Optimization on Calulus of Variations </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Statistics </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Statistics </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_1> <label class=md-nav__link for=__nav_7_1 id=__nav_7_1_label tabindex=0> <span class=md-ellipsis> STA303/1002 Methods of Data Analysis II </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_1_label aria-expanded=false> <label class=md-nav__title for=__nav_7_1> <span class="md-nav__icon md-icon"></span> STA303/1002 Methods of Data Analysis II </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../sta303/Summary.html class=md-nav__link> <span class=md-ellipsis> Summary Sheet </span> </a> </li> <li class=md-nav__item> <a href=../sta303/two_way_ANOVA.html class=md-nav__link> <span class=md-ellipsis> Two Way ANOVA </span> </a> </li> <li class=md-nav__item> <a href=../sta303/multi_comparisons.html class=md-nav__link> <span class=md-ellipsis> Multi Comparisons and One Way ANOVA </span> </a> </li> <li class=md-nav__item> <a href=../sta303/binary_logistic_regression.html class=md-nav__link> <span class=md-ellipsis> Binary logistic regression </span> </a> </li> <li class=md-nav__item> <a href=../sta303/case_spock.html class=md-nav__link> <span class=md-ellipsis> One Way ANOVA </span> </a> </li> <li class=md-nav__item> <a href=../sta303/binomial_logistic_regression.html class=md-nav__link> <span class=md-ellipsis> Binomial Logistic Regression </span> </a> </li> <li class=md-nav__item> <a href=../sta303/poisson_regression.html class=md-nav__link> <span class=md-ellipsis> Log-linear Regression (Poisson Regression) </span> </a> </li> <li class=md-nav__item> <a href=../sta303/contingency.html class=md-nav__link> <span class=md-ellipsis> Factor independence and Contingency Table </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2> <label class=md-nav__link for=__nav_7_2 id=__nav_7_2_label tabindex=0> <span class=md-ellipsis> STA347 Probability I </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_2_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2> <span class="md-nav__icon md-icon"></span> STA347 Probability I </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../sta347/probability.html class=md-nav__link> <span class=md-ellipsis> Introduction to Probability </span> </a> </li> <li class=md-nav__item> <a href=../sta347/distribution.html class=md-nav__link> <span class=md-ellipsis> Random Variables and Single Variable Distributions </span> </a> </li> <li class=md-nav__item> <a href=../sta347/mv_distribution.html class=md-nav__link> <span class=md-ellipsis> Multivariate Distributions </span> </a> </li> <li class=md-nav__item> <a href=../sta347/function_rv.html class=md-nav__link> <span class=md-ellipsis> Functions of Random Variable </span> </a> </li> <li class=md-nav__item> <a href=../sta347/expectations.html class=md-nav__link> <span class=md-ellipsis> Expectations </span> </a> </li> <li class=md-nav__item> <a href=../sta347/var.html class=md-nav__link> <span class=md-ellipsis> Variance and Covariance </span> </a> </li> <li class=md-nav__item> <a href=../sta347/ineq.html class=md-nav__link> <span class=md-ellipsis> Inequalities Related to Expecations </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_3> <label class=md-nav__link for=__nav_7_3 id=__nav_7_3_label tabindex=0> <span class=md-ellipsis> STA355 Theory of Statistical Practice </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_3_label aria-expanded=false> <label class=md-nav__title for=__nav_7_3> <span class="md-nav__icon md-icon"></span> STA355 Theory of Statistical Practice </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../sta355/statistical_models.html class=md-nav__link> <span class=md-ellipsis> Statistical Models </span> </a> </li> <li class=md-nav__item> <a href=../sta355/order_statistics.html class=md-nav__link> <span class=md-ellipsis> Order Statistics </span> </a> </li> <li class=md-nav__item> <a href=../sta355/spacings.html class=md-nav__link> <span class=md-ellipsis> Spacings </span> </a> </li> <li class=md-nav__item> <a href=../sta355/density_estimation.html class=md-nav__link> <span class=md-ellipsis> Density Estimation </span> </a> </li> <li class=md-nav__item> <a href=../sta355/methods_of_estimation.html class=md-nav__link> <span class=md-ellipsis> Methods of Estimation </span> </a> </li> <li class=md-nav__item> <a href=../sta355/bayes_inference.html class=md-nav__link> <span class=md-ellipsis> Bayes Inference </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_4> <label class=md-nav__link for=__nav_7_4 id=__nav_7_4_label tabindex=0> <span class=md-ellipsis> STA457/2202 Time Series Analysis </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_4_label aria-expanded=false> <label class=md-nav__title for=__nav_7_4> <span class="md-nav__icon md-icon"></span> STA457/2202 Time Series Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../sta457/Summary.html class=md-nav__link> <span class=md-ellipsis> Summary Sheet </span> </a> </li> <li class=md-nav__item> <a href=../sta457/Introduction.html class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../sta457/ARMA.html class=md-nav__link> <span class=md-ellipsis> Autoregressive (AR) and Moving Average (MA) model </span> </a> </li> <li class=md-nav__item> <a href=../sta457/ARIMA.html class=md-nav__link> <span class=md-ellipsis> Autoregressive Integrated Moving Average (ARIMA) model </span> </a> </li> <li class=md-nav__item> <a href=../sta457/Forecasting.html class=md-nav__link> <span class=md-ellipsis> Forecasting and Transfer Function Noise Model </span> </a> </li> <li class=md-nav__item> <a href=../sta457/VAR.html class=md-nav__link> <span class=md-ellipsis> Vector Series (VAR Models) </span> </a> </li> <li class=md-nav__item> <a href=../sta457/granger_causality_and_cointegration.html class=md-nav__link> <span class=md-ellipsis> Granger Causality and Co-integration </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://haoda-li.github.io/ class=md-nav__link> <span class=md-ellipsis> Main </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#trainium-hardware-architecture class=md-nav__link> <span class=md-ellipsis> Trainium Hardware Architecture </span> </a> <nav class=md-nav aria-label="Trainium Hardware Architecture"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#systolic-arrays class=md-nav__link> <span class=md-ellipsis> Systolic Arrays </span> </a> </li> <li class=md-nav__item> <a href=#psum-constraints class=md-nav__link> <span class=md-ellipsis> PSUM Constraints </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#nki-neuron-kernel-interface class=md-nav__link> <span class=md-ellipsis> NKI (Neuron Kernel Interface) </span> </a> </li> <li class=md-nav__item> <a href=#data-tiling class=md-nav__link> <span class=md-ellipsis> Data Tiling </span> </a> <nav class=md-nav aria-label="Data Tiling"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#partition-dimension class=md-nav__link> <span class=md-ellipsis> Partition Dimension </span> </a> </li> <li class=md-nav__item> <a href=#free-dimension class=md-nav__link> <span class=md-ellipsis> Free Dimension </span> </a> </li> <li class=md-nav__item> <a href=#data-movement-and-computation class=md-nav__link> <span class=md-ellipsis> Data Movement and Computation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#tensor-engine-matrix-multiplication class=md-nav__link> <span class=md-ellipsis> Tensor Engine: Matrix Multiplication </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=aws-trainium-and-nki-kernel>AWS Trainium and NKI kernel</h1> <p>Based on <a href=https://github.com/stanford-cs149/asst4-trainium>Stanford CS149 Assignment</a>, <a href=https://awsdocs-neuron.readthedocs-hosted.com/en/latest/general/nki/index.html><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M.045 18.02q.107-.174.348-.022 5.455 3.165 11.87 3.166 4.278-.001 8.447-1.595l.315-.14c.138-.06.234-.1.293-.13.226-.088.39-.046.525.13.12.174.09.336-.12.48-.256.19-.6.41-1.006.654q-1.867 1.113-4.185 1.726a17.6 17.6 0 0 1-10.951-.577 17.9 17.9 0 0 1-5.43-3.35q-.15-.113-.151-.22c0-.047.021-.09.051-.13zm6.565-6.218q0-1.507.743-2.577c.495-.71 1.17-1.25 2.04-1.615.796-.335 1.756-.575 2.912-.72.39-.046 1.033-.103 1.92-.174v-.37c0-.93-.105-1.558-.3-1.875-.302-.43-.78-.65-1.44-.65h-.182c-.48.046-.896.196-1.246.46-.35.27-.575.63-.675 1.096-.06.3-.206.465-.435.51l-2.52-.315c-.248-.06-.372-.18-.372-.39 0-.046.007-.09.022-.15q.372-1.935 1.82-2.88c.976-.616 2.1-.975 3.39-1.05h.54c1.65 0 2.957.434 3.888 1.29.135.15.27.3.405.48.12.165.224.314.283.45.075.134.15.33.195.57.06.254.105.42.135.51.03.104.062.3.076.615.01.313.02.493.02.553v5.28c0 .376.06.72.165 1.036q.157.471.315.674l.51.674q.136.204.136.36 0 .181-.18.314c-1.2 1.05-1.86 1.62-1.963 1.71q-.247.203-.63.045a6 6 0 0 1-.526-.496l-.31-.347a9 9 0 0 1-.317-.42l-.3-.435c-.81.886-1.603 1.44-2.4 1.665-.494.15-1.093.227-1.83.227-1.11 0-2.04-.343-2.76-1.034-.72-.69-1.08-1.665-1.08-2.94l-.05-.076zm3.753-.438q-.001.848.425 1.364c.285.34.675.512 1.155.512.045 0 .106-.007.195-.02.09-.016.134-.023.166-.023.614-.16 1.08-.553 1.424-1.178.165-.28.285-.58.36-.91.09-.32.12-.59.135-.8.015-.195.015-.54.015-1.005v-.54c-.84 0-1.484.06-1.92.18-1.275.36-1.92 1.17-1.92 2.43l-.035-.02zm9.162 7.027c.03-.06.075-.11.132-.17q.544-.365 1.05-.5a8 8 0 0 1 1.612-.24c.14-.012.28 0 .41.03.65.06 1.05.168 1.172.33.063.09.099.228.099.39v.15c0 .51-.149 1.11-.424 1.8q-.418 1.034-1.156 1.68-.11.09-.197.09c-.03 0-.06 0-.09-.012-.09-.044-.107-.12-.064-.24.54-1.26.806-2.143.806-2.64 0-.15-.03-.27-.087-.344-.145-.166-.55-.257-1.224-.257q-.364 0-.87.046c-.363.045-.7.09-1 .135q-.134 0-.18-.044c-.03-.03-.036-.047-.02-.077 0-.017.006-.03.02-.063v-.06z"></path></svg></span> NKI kernel Docs</a></p> <h2 id=trainium-hardware-architecture><a href=https://awsdocs-neuron.readthedocs-hosted.com/en/latest/general/nki/trainium_inferentia2_arch.html>Trainium Hardware Architecture</a></h2> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=auto href=assets/neuroncore.jpg><img alt="Neuron Core" src=assets/neuroncore.jpg width=720></a></p> <ul> <li><strong>HBM</strong>: High bandwidth memory, device memory. Host to device should be managed by ML framework or external of NKI kernel. </li> <li><strong>SBUF</strong>: State buffer. Software-managed on-chip SRAM. In NKI programming, on-chip SRAM is not a hardware managerd "cache", <strong>HBM to SBUF needs explicit <code>load</code> and <code>store</code>.</strong> </li> <li><strong>PSUM</strong>: Partial Sum Buffer, a small, dedicated memory designed for storing matrix multiplication results. </li> <li><strong>Tensor Engine</strong>: for matmuls, or other operators that can be executed as matmuls. The engine has 128x128 systolic processing elements, which streams input data from SBUF and write output to PSUM. </li> <li><strong>Vector Engine</strong>: for vector operations that depends on multiple elements from input tensors (vector reduction, element-wise binary operations). VectorE consists of 128 parallel vector lanes. </li> <li><strong>Scaler Engine</strong>: for element-wise operations, where every element in the output tensor only depends on one element of the input tensor. Usually used for hardware-accelerated activation functions. ScalarE consists of 128 parallel vector lanes. </li> <li><strong>GpSimd Engine</strong>: for general SIMD operations. Basically a 8-core CPU, with 512-bit vector machine. </li> </ul> <h3 id=systolic-arrays>Systolic Arrays</h3> <p>Trainium chips are operated in systolic arrays, hence all data movements and computations are tiled. From the hardware perspective, the on-chip memories, SBUF and PSUM, are arranged as 2D memory arrays. The first dimension is the partition dimension <code>P</code> with <code>nki.tile_size.pmax = 128</code> memory partitions that can be read and written in parallel by compute engines. The second dimension is the free dimension <code>F</code> where elements are read and written sequentially.</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=auto href=assets/pm-layout.jpeg><img alt="Partition Layout" src=assets/pm-layout.jpeg width=560></a></p> <h3 id=psum-constraints><code>PSUM</code> Constraints</h3> <p>Remind that <code>PSUM</code> is the small, dedicated on-chip memory for matmul reduction operations. Currently, its size is <code>2MiB</code>. The hardware design poses a constraint for tiles in PSUM, <code>nki.tile_size.psum_fmax == 512</code>, which comes from <code>2MiB / 128 / 32B</code>. </p> <p>For matrix multiplicaion of size <span class=arithmatex>\((M, K) \times (K, N)\)</span>. The contraction dimension <span class=arithmatex>\(K\)</span> consider how matrix is mapped onto tensorE and PSUM. We define that input tiles F dimension size must not exceed <code>M_per_tile = nki.tile_size.gemm_stationary_fmax == 128</code> on the left-hand side (LHS), or <code>N_per_tile = nki.tile_size.gemm_moving_fmax == 512</code> on the right hand size (RHS). More explanation in <a href=#tensor-engine-matrix-multiplication>Tensor Engine: Matrix Multiplication</a>.</p> <h2 id=nki-neuron-kernel-interface>NKI (Neuron Kernel Interface)</h2> <p>NKI kernels are written in Python. Essentially, NKI programming and some optimization considerations are</p> <ol> <li> <p>Loading data from HBM to on-chip SBUF</p> <ul> <li>How to minimize the data movement.</li> <li>How to do data tiling so that we can fully use the 128 lane.</li> </ul> </li> <li> <p>Computations on the compute engines</p> <ul> <li>How to overlap computations on different cores. </li> </ul> </li> <li> <p>Storing outputs from SBUF back to HBM</p> </li> </ol> <p>Each NKI kernel is a python function decorated with <code>@nki.jit</code>, and the arguments should be tensors already reside in HBM. NKI kernels can be directly inserted into ML frameworks (PyTorch, Tensorflow). </p> <div class=highlight><pre><span></span><code><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=nd>@nki</span><span class=o>.</span><span class=n>jit</span>
<a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=k>def</span> <span class=nf>vector_add</span><span class=p>(</span><span class=n>a_vec</span><span class=p>:</span> <span class=n>Tensor</span><span class=p>,</span> <span class=n>b_vec</span><span class=p>:</span> <span class=n>Tensor</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tensor</span><span class=p>:</span>
<a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=c1># Allocate space for the output vector in HBM</span>
<a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>    <span class=n>out</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>ndarray</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=n>a_vec</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>a_vec</span><span class=o>.</span><span class=n>dtype</span><span class=p>,</span> <span class=n>buffer</span><span class=o>=</span><span class=n>nl</span><span class=o>.</span><span class=n>hbm</span><span class=p>)</span>
<a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>
<a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>    <span class=c1># Load the input vectors from HBM into variables stored in SBUF </span>
<a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>    <span class=n>a</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>a_vec</span><span class=p>)</span>
<a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=n>b</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>b_vec</span><span class=p>)</span>
<a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>
<a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=c1># Add the input vectors</span>
<a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=n>res</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span>
<a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>
<a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>    <span class=c1># Store the result into HBM</span>
<a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=n>nl</span><span class=o>.</span><span class=n>store</span><span class=p>(</span><span class=n>out</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=n>res</span><span class=p>)</span>
<a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>
<a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>    <span class=k>return</span> <span class=n>out</span>
</code></pre></div> <p>NKI provides a <code>nki.baremetal</code> decorator function to directly run kernels from numpy arrays. </p> <div class=highlight><pre><span></span><code><a href=#__codelineno-1-1 id=__codelineno-1-1 name=__codelineno-1-1></a><span class=n>vec_size</span> <span class=o>=</span> <span class=n>nki</span><span class=o>.</span><span class=n>tile_size</span><span class=o>.</span><span class=n>pmax</span> <span class=c1># 128</span>
<a href=#__codelineno-1-2 id=__codelineno-1-2 name=__codelineno-1-2></a><span class=n>a</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=n>vec_size</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
<a href=#__codelineno-1-3 id=__codelineno-1-3 name=__codelineno-1-3></a><span class=n>b</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=n>vec_size</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
<a href=#__codelineno-1-4 id=__codelineno-1-4 name=__codelineno-1-4></a><span class=n>out</span> <span class=o>=</span> <span class=n>nki</span><span class=o>.</span><span class=n>baremetal</span><span class=p>(</span><span class=n>vector_add</span><span class=p>)(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span>
</code></pre></div> <h2 id=data-tiling>Data Tiling</h2> <p>The on-chip memories, SBUF and PSUM, store data that is arranged as 2D memory arrays. The first dimension of the 2D array is called the "partition dimension" P. The second dimension is referred to as the "free dimension" F (more details later). For vector add, we have <code>P = vec_size, F = 1</code></p> <h3 id=partition-dimension>Partition Dimension</h3> <p>Note that if we run the above code with <code>vec_size &gt; 128</code>, we get </p> <div class=highlight><pre><span></span><code><a href=#__codelineno-2-1 id=__codelineno-2-1 name=__codelineno-2-1></a>&gt; a = nl.load(a_vec)
<a href=#__codelineno-2-2 id=__codelineno-2-2 name=__codelineno-2-2></a>
<a href=#__codelineno-2-3 id=__codelineno-2-3 name=__codelineno-2-3></a>Value Error: number of partition in src[12800, 1] of 'load' 
<a href=#__codelineno-2-4 id=__codelineno-2-4 name=__codelineno-2-4></a>exceed architecture limitation of 128.
</code></pre></div> <p>NeuronCores loads 128 elements in parallel along the P-dim in each cycle, which means the max size of P dimension for each <code>nl.load</code> is 128. Therefore, we need to manually tile of data into 128 chunks. </p> <div class=highlight><pre><span></span><code><a href=#__codelineno-3-1 id=__codelineno-3-1 name=__codelineno-3-1></a><span class=nd>@nki</span><span class=o>.</span><span class=n>jit</span>
<a href=#__codelineno-3-2 id=__codelineno-3-2 name=__codelineno-3-2></a><span class=k>def</span> <span class=nf>vector_add_tiled</span><span class=p>(</span><span class=n>a_vec</span><span class=p>,</span> <span class=n>b_vec</span><span class=p>):</span>
<a href=#__codelineno-3-3 id=__codelineno-3-3 name=__codelineno-3-3></a>
<a href=#__codelineno-3-4 id=__codelineno-3-4 name=__codelineno-3-4></a>    <span class=n>CHUNK_SIZE</span> <span class=o>=</span> <span class=n>nki</span><span class=o>.</span><span class=n>tile_size</span><span class=o>.</span><span class=n>pmax</span>  <span class=c1># 128</span>
<a href=#__codelineno-3-5 id=__codelineno-3-5 name=__codelineno-3-5></a>
<a href=#__codelineno-3-6 id=__codelineno-3-6 name=__codelineno-3-6></a>    <span class=n>out</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>ndarray</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=n>a_vec</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>a_vec</span><span class=o>.</span><span class=n>dtype</span><span class=p>,</span> <span class=n>buffer</span><span class=o>=</span><span class=n>nl</span><span class=o>.</span><span class=n>hbm</span><span class=p>)</span>
<a href=#__codelineno-3-7 id=__codelineno-3-7 name=__codelineno-3-7></a>    <span class=n>M</span> <span class=o>=</span> <span class=n>a_vec</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a href=#__codelineno-3-8 id=__codelineno-3-8 name=__codelineno-3-8></a>
<a href=#__codelineno-3-9 id=__codelineno-3-9 name=__codelineno-3-9></a>    <span class=c1># nl.affine_range assumes there are no loop-carried dependencies</span>
<a href=#__codelineno-3-10 id=__codelineno-3-10 name=__codelineno-3-10></a>    <span class=c1># and allow more aggressive optimizations for the compiler pipelining</span>
<a href=#__codelineno-3-11 id=__codelineno-3-11 name=__codelineno-3-11></a>    <span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>nl</span><span class=o>.</span><span class=n>affine_range</span><span class=p>((</span><span class=n>M</span> <span class=o>//</span> <span class=n>ROW_CHUNK</span><span class=p>)):</span>
<a href=#__codelineno-3-12 id=__codelineno-3-12 name=__codelineno-3-12></a>
<a href=#__codelineno-3-13 id=__codelineno-3-13 name=__codelineno-3-13></a>        <span class=c1># Allocate row-chunk sized tiles for the input vectors</span>
<a href=#__codelineno-3-14 id=__codelineno-3-14 name=__codelineno-3-14></a>        <span class=n>a_tile</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>ndarray</span><span class=p>((</span><span class=n>CHUNK_SIZE</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>a_vec</span><span class=o>.</span><span class=n>dtype</span><span class=p>,</span> <span class=n>buffer</span><span class=o>=</span><span class=n>nl</span><span class=o>.</span><span class=n>sbuf</span><span class=p>)</span>
<a href=#__codelineno-3-15 id=__codelineno-3-15 name=__codelineno-3-15></a>        <span class=n>b_tile</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>ndarray</span><span class=p>((</span><span class=n>CHUNK_SIZE</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>b_vec</span><span class=o>.</span><span class=n>dtype</span><span class=p>,</span> <span class=n>buffer</span><span class=o>=</span><span class=n>nl</span><span class=o>.</span><span class=n>sbuf</span><span class=p>)</span>
<a href=#__codelineno-3-16 id=__codelineno-3-16 name=__codelineno-3-16></a>
<a href=#__codelineno-3-17 id=__codelineno-3-17 name=__codelineno-3-17></a>        <span class=c1># Load a chunk of rows</span>
<a href=#__codelineno-3-18 id=__codelineno-3-18 name=__codelineno-3-18></a>        <span class=n>a_tile</span><span class=p>[</span><span class=o>...</span><span class=p>]</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>a_vec</span><span class=p>[</span><span class=n>m</span> <span class=o>*</span> <span class=n>CHUNK_SIZE</span> <span class=p>:</span> <span class=p>(</span><span class=n>m</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=n>CHUNK_SIZE</span><span class=p>])</span>
<a href=#__codelineno-3-19 id=__codelineno-3-19 name=__codelineno-3-19></a>        <span class=n>b_tile</span><span class=p>[</span><span class=o>...</span><span class=p>]</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>b_vec</span><span class=p>[</span><span class=n>m</span> <span class=o>*</span> <span class=n>CHUNK_SIZE</span> <span class=p>:</span> <span class=p>(</span><span class=n>m</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=n>CHUNK_SIZE</span><span class=p>])</span>
<a href=#__codelineno-3-20 id=__codelineno-3-20 name=__codelineno-3-20></a>
<a href=#__codelineno-3-21 id=__codelineno-3-21 name=__codelineno-3-21></a>        <span class=n>res</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>a_tile</span><span class=p>,</span> <span class=n>b_tile</span><span class=p>)</span>
<a href=#__codelineno-3-22 id=__codelineno-3-22 name=__codelineno-3-22></a>        <span class=n>nl</span><span class=o>.</span><span class=n>store</span><span class=p>(</span><span class=n>out</span><span class=p>[</span><span class=n>m</span> <span class=o>*</span> <span class=n>CHUNK_SIZE</span> <span class=p>:</span> <span class=p>(</span><span class=n>m</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=n>CHUNK_SIZE</span><span class=p>],</span> <span class=n>value</span><span class=o>=</span><span class=n>res</span><span class=p>)</span>
<a href=#__codelineno-3-23 id=__codelineno-3-23 name=__codelineno-3-23></a>
<a href=#__codelineno-3-24 id=__codelineno-3-24 name=__codelineno-3-24></a>    <span class=k>return</span> <span class=n>out</span>
</code></pre></div> <h3 id=free-dimension>Free Dimension</h3> <p>The compiler is responsible the <code>store</code> and <code>load</code> are converted into direct memory access (DMA) instructions. Similar to how CUDA hides the data loading to threads, NeuronCore has 16 DMA engines to move multiple lanes of data in parallel / in pipeline. DMA are parallelized over the free dimension. In addition, the computation engines support pipelining over the free dimension. </p> <div class=highlight><pre><span></span><code><a href=#__codelineno-4-1 id=__codelineno-4-1 name=__codelineno-4-1></a><span class=nd>@nki</span><span class=o>.</span><span class=n>jit</span>
<a href=#__codelineno-4-2 id=__codelineno-4-2 name=__codelineno-4-2></a><span class=k>def</span> <span class=nf>vector_add_stream</span><span class=p>(</span><span class=n>a_vec</span><span class=p>,</span> <span class=n>b_vec</span><span class=p>):</span>
<a href=#__codelineno-4-3 id=__codelineno-4-3 name=__codelineno-4-3></a>
<a href=#__codelineno-4-4 id=__codelineno-4-4 name=__codelineno-4-4></a>    <span class=c1># The maximum size of our Partition Dimension</span>
<a href=#__codelineno-4-5 id=__codelineno-4-5 name=__codelineno-4-5></a>    <span class=n>PARTITION_DIM</span> <span class=o>=</span> <span class=n>nki</span><span class=o>.</span><span class=n>tile_size</span><span class=o>.</span><span class=n>pmax</span> <span class=c1># 128</span>
<a href=#__codelineno-4-6 id=__codelineno-4-6 name=__codelineno-4-6></a>
<a href=#__codelineno-4-7 id=__codelineno-4-7 name=__codelineno-4-7></a>    <span class=c1># Free dim is a tunable parameter, and it depends on</span>
<a href=#__codelineno-4-8 id=__codelineno-4-8 name=__codelineno-4-8></a>    <span class=c1># compiler optimizations/hardware specifications</span>
<a href=#__codelineno-4-9 id=__codelineno-4-9 name=__codelineno-4-9></a>    <span class=n>FREE_DIM</span> <span class=o>=</span> <span class=mi>200</span>
<a href=#__codelineno-4-10 id=__codelineno-4-10 name=__codelineno-4-10></a>
<a href=#__codelineno-4-11 id=__codelineno-4-11 name=__codelineno-4-11></a>    <span class=c1># The total size of each tile</span>
<a href=#__codelineno-4-12 id=__codelineno-4-12 name=__codelineno-4-12></a>    <span class=n>TILE_M</span> <span class=o>=</span> <span class=n>PARTITION_DIM</span> <span class=o>*</span> <span class=n>FREE_DIM</span>
<a href=#__codelineno-4-13 id=__codelineno-4-13 name=__codelineno-4-13></a>
<a href=#__codelineno-4-14 id=__codelineno-4-14 name=__codelineno-4-14></a>    <span class=c1># Get the total number of vector rows</span>
<a href=#__codelineno-4-15 id=__codelineno-4-15 name=__codelineno-4-15></a>    <span class=n>M</span> <span class=o>=</span> <span class=n>a_vec</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a href=#__codelineno-4-16 id=__codelineno-4-16 name=__codelineno-4-16></a>
<a href=#__codelineno-4-17 id=__codelineno-4-17 name=__codelineno-4-17></a>
<a href=#__codelineno-4-18 id=__codelineno-4-18 name=__codelineno-4-18></a>    <span class=c1># Reshape the the input vectors</span>
<a href=#__codelineno-4-19 id=__codelineno-4-19 name=__codelineno-4-19></a>    <span class=n>a_vec_re</span> <span class=o>=</span> <span class=n>a_vec</span><span class=o>.</span><span class=n>reshape</span><span class=p>((</span><span class=n>M</span> <span class=o>//</span> <span class=n>TILE_M</span><span class=p>,</span> <span class=n>PARTITION_DIM</span><span class=p>,</span> <span class=n>FREE_DIM</span><span class=p>))</span>
<a href=#__codelineno-4-20 id=__codelineno-4-20 name=__codelineno-4-20></a>    <span class=n>b_vec_re</span> <span class=o>=</span> <span class=n>b_vec</span><span class=o>.</span><span class=n>reshape</span><span class=p>((</span><span class=n>M</span> <span class=o>//</span> <span class=n>TILE_M</span><span class=p>,</span> <span class=n>PARTITION_DIM</span><span class=p>,</span> <span class=n>FREE_DIM</span><span class=p>))</span>
<a href=#__codelineno-4-21 id=__codelineno-4-21 name=__codelineno-4-21></a>
<a href=#__codelineno-4-22 id=__codelineno-4-22 name=__codelineno-4-22></a>    <span class=c1># Allocate space for the reshaped output vector in HBM</span>
<a href=#__codelineno-4-23 id=__codelineno-4-23 name=__codelineno-4-23></a>    <span class=n>out</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>ndarray</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=n>a_vec_re</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>a_vec_re</span><span class=o>.</span><span class=n>dtype</span><span class=p>,</span> <span class=n>buffer</span><span class=o>=</span><span class=n>nl</span><span class=o>.</span><span class=n>hbm</span><span class=p>)</span>
<a href=#__codelineno-4-24 id=__codelineno-4-24 name=__codelineno-4-24></a>
<a href=#__codelineno-4-25 id=__codelineno-4-25 name=__codelineno-4-25></a>    <span class=c1># Loop over the total number of tiles</span>
<a href=#__codelineno-4-26 id=__codelineno-4-26 name=__codelineno-4-26></a>    <span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>nl</span><span class=o>.</span><span class=n>affine_range</span><span class=p>((</span><span class=n>M</span> <span class=o>//</span> <span class=n>TILE_M</span><span class=p>)):</span>
<a href=#__codelineno-4-27 id=__codelineno-4-27 name=__codelineno-4-27></a>
<a href=#__codelineno-4-28 id=__codelineno-4-28 name=__codelineno-4-28></a>        <span class=c1># Allocate space for a reshaped tile</span>
<a href=#__codelineno-4-29 id=__codelineno-4-29 name=__codelineno-4-29></a>        <span class=n>a_tile</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>ndarray</span><span class=p>((</span><span class=n>PARTITION_DIM</span><span class=p>,</span> <span class=n>FREE_DIM</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>a_vec</span><span class=o>.</span><span class=n>dtype</span><span class=p>,</span> <span class=n>buffer</span><span class=o>=</span><span class=n>nl</span><span class=o>.</span><span class=n>sbuf</span><span class=p>)</span>
<a href=#__codelineno-4-30 id=__codelineno-4-30 name=__codelineno-4-30></a>        <span class=n>b_tile</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>ndarray</span><span class=p>((</span><span class=n>PARTITION_DIM</span><span class=p>,</span> <span class=n>FREE_DIM</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>a_vec</span><span class=o>.</span><span class=n>dtype</span><span class=p>,</span> <span class=n>buffer</span><span class=o>=</span><span class=n>nl</span><span class=o>.</span><span class=n>sbuf</span><span class=p>)</span>
<a href=#__codelineno-4-31 id=__codelineno-4-31 name=__codelineno-4-31></a>
<a href=#__codelineno-4-32 id=__codelineno-4-32 name=__codelineno-4-32></a>        <span class=c1># Load the input tiles</span>
<a href=#__codelineno-4-33 id=__codelineno-4-33 name=__codelineno-4-33></a>        <span class=n>a_tile</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>a_vec_re</span><span class=p>[</span><span class=n>m</span><span class=p>])</span>
<a href=#__codelineno-4-34 id=__codelineno-4-34 name=__codelineno-4-34></a>        <span class=n>b_tile</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>b_vec_re</span><span class=p>[</span><span class=n>m</span><span class=p>])</span>
<a href=#__codelineno-4-35 id=__codelineno-4-35 name=__codelineno-4-35></a>
<a href=#__codelineno-4-36 id=__codelineno-4-36 name=__codelineno-4-36></a>        <span class=c1># Add the tiles together</span>
<a href=#__codelineno-4-37 id=__codelineno-4-37 name=__codelineno-4-37></a>        <span class=n>res</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>a_tile</span><span class=p>,</span> <span class=n>b_tile</span><span class=p>)</span>
<a href=#__codelineno-4-38 id=__codelineno-4-38 name=__codelineno-4-38></a>
<a href=#__codelineno-4-39 id=__codelineno-4-39 name=__codelineno-4-39></a>        <span class=c1># Store the result tile into HBM</span>
<a href=#__codelineno-4-40 id=__codelineno-4-40 name=__codelineno-4-40></a>        <span class=n>nl</span><span class=o>.</span><span class=n>store</span><span class=p>(</span><span class=n>out</span><span class=p>[</span><span class=n>m</span><span class=p>],</span> <span class=n>value</span><span class=o>=</span><span class=n>res</span><span class=p>)</span>
<a href=#__codelineno-4-41 id=__codelineno-4-41 name=__codelineno-4-41></a>
<a href=#__codelineno-4-42 id=__codelineno-4-42 name=__codelineno-4-42></a>    <span class=c1># Reshape the output vector into its original shape</span>
<a href=#__codelineno-4-43 id=__codelineno-4-43 name=__codelineno-4-43></a>    <span class=n>out</span> <span class=o>=</span> <span class=n>out</span><span class=o>.</span><span class=n>reshape</span><span class=p>((</span><span class=n>M</span><span class=p>,))</span>
<a href=#__codelineno-4-44 id=__codelineno-4-44 name=__codelineno-4-44></a>
<a href=#__codelineno-4-45 id=__codelineno-4-45 name=__codelineno-4-45></a>    <span class=k>return</span> <span class=n>out</span>
</code></pre></div> <h3 id=data-movement-and-computation>Data Movement and Computation</h3> <p>F-dim is a tunable parameter, each DMA transfer has an overhead. However, F-dim is not always a "bigger means better" thing. Choosing a smaller F-dim may allow a better pipelining. In this case, since <code>add</code> requires small computation cycles, smaller free-dim means more but quicker data movement, and allow for more overlapping between the engines. In practice, we need to profile and decide the dimension size to harness better performance. </p> <h2 id=tensor-engine-matrix-multiplication>Tensor Engine: Matrix Multiplication</h2> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=auto href=assets/matrix-multiplication-views.jpeg><img alt=Matmul src=assets/matrix-multiplication-views.jpeg></a></p> <p>Consider the matmul, note that the hardware constrains that PSUM can only hold <span class=arithmatex>\(128\times 512\)</span> elements. Thus, <code>TILE_M = nki.tile_size.gemm_stationary_fmax == 128</code>, <code>TILE_N = nki.tile_size.gemm_moving_fmax == 512</code>. In addition, the contraction dimension <span class=arithmatex>\(K\)</span> has to be loaded in parallel and do element-wise multiplication, thus <code>TILE_K = nki.tile_size.pmax = 128</code>.</p> <p>Similar to any parallel programming architecture, data locality (reducing data loading) is a key optimization. Check <a href=/csc367/matrix.html#blocked-tiled-matrix-multiplication>Matrix Multiplications notes</a>. Reordering loop (<code>nkm</code> instead <code>mnk</code> to avoid reloading lhs elements) and blocked matmul apply to our case. </p> <p>For trainium, <code>SBUF</code> is <code>24MiB</code>. Assuming that we know the dtype and the rough shape of matrices (so that we can better choose number of tiles per block), we can compute the number of blocks s.t. data movement is minimized. </p> <details class=quote> <summary>nki blocked matmul</summary> <div class=highlight><pre><span></span><code><a href=#__codelineno-5-1 id=__codelineno-5-1 name=__codelineno-5-1></a><span class=kn>import</span> <span class=nn>neuronxcc.nki</span> <span class=k>as</span> <span class=nn>nki</span>
<a href=#__codelineno-5-2 id=__codelineno-5-2 name=__codelineno-5-2></a><span class=kn>import</span> <span class=nn>neuronxcc.nki.language</span> <span class=k>as</span> <span class=nn>nl</span>
<a href=#__codelineno-5-3 id=__codelineno-5-3 name=__codelineno-5-3></a><span class=kn>import</span> <span class=nn>neuronxcc.nki.isa</span> <span class=k>as</span> <span class=nn>nisa</span>
<a href=#__codelineno-5-4 id=__codelineno-5-4 name=__codelineno-5-4></a>
<a href=#__codelineno-5-5 id=__codelineno-5-5 name=__codelineno-5-5></a><span class=nd>@nki</span><span class=o>.</span><span class=n>jit</span>
<a href=#__codelineno-5-6 id=__codelineno-5-6 name=__codelineno-5-6></a><span class=k>def</span> <span class=nf>nki_matmul_fully_optimized_</span><span class=p>(</span>
<a href=#__codelineno-5-7 id=__codelineno-5-7 name=__codelineno-5-7></a>    <span class=n>lhsT</span><span class=p>,</span>
<a href=#__codelineno-5-8 id=__codelineno-5-8 name=__codelineno-5-8></a>    <span class=n>rhs</span><span class=p>,</span>
<a href=#__codelineno-5-9 id=__codelineno-5-9 name=__codelineno-5-9></a><span class=p>):</span>
<a href=#__codelineno-5-10 id=__codelineno-5-10 name=__codelineno-5-10></a>
<a href=#__codelineno-5-11 id=__codelineno-5-11 name=__codelineno-5-11></a>  <span class=n>TILES_IN_BLOCK_M</span><span class=o>=</span><span class=mi>16</span>
<a href=#__codelineno-5-12 id=__codelineno-5-12 name=__codelineno-5-12></a>  <span class=n>TILES_IN_BLOCK_N</span><span class=o>=</span><span class=mi>2</span>
<a href=#__codelineno-5-13 id=__codelineno-5-13 name=__codelineno-5-13></a>  <span class=n>TILES_IN_BLOCK_K</span><span class=o>=</span><span class=mi>8</span>
<a href=#__codelineno-5-14 id=__codelineno-5-14 name=__codelineno-5-14></a>
<a href=#__codelineno-5-15 id=__codelineno-5-15 name=__codelineno-5-15></a>  <span class=n>K</span><span class=p>,</span> <span class=n>M</span> <span class=o>=</span> <span class=n>lhsT</span><span class=o>.</span><span class=n>shape</span>
<a href=#__codelineno-5-16 id=__codelineno-5-16 name=__codelineno-5-16></a>  <span class=n>K_</span><span class=p>,</span> <span class=n>N</span> <span class=o>=</span> <span class=n>rhs</span><span class=o>.</span><span class=n>shape</span>
<a href=#__codelineno-5-17 id=__codelineno-5-17 name=__codelineno-5-17></a>  <span class=k>assert</span> <span class=n>K</span> <span class=o>==</span> <span class=n>K_</span><span class=p>,</span> <span class=s2>"lhsT and rhs must have the same contraction dimension"</span>
<a href=#__codelineno-5-18 id=__codelineno-5-18 name=__codelineno-5-18></a>  <span class=n>result</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>ndarray</span><span class=p>((</span><span class=n>M</span><span class=p>,</span> <span class=n>N</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>lhsT</span><span class=o>.</span><span class=n>dtype</span><span class=p>,</span> <span class=n>buffer</span><span class=o>=</span><span class=n>nl</span><span class=o>.</span><span class=n>shared_hbm</span><span class=p>)</span>
<a href=#__codelineno-5-19 id=__codelineno-5-19 name=__codelineno-5-19></a>
<a href=#__codelineno-5-20 id=__codelineno-5-20 name=__codelineno-5-20></a>  <span class=n>TILE_M</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>tile_size</span><span class=o>.</span><span class=n>gemm_stationary_fmax</span>  <span class=c1># 128</span>
<a href=#__codelineno-5-21 id=__codelineno-5-21 name=__codelineno-5-21></a>  <span class=n>TILE_K</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>tile_size</span><span class=o>.</span><span class=n>pmax</span>  <span class=c1># 128</span>
<a href=#__codelineno-5-22 id=__codelineno-5-22 name=__codelineno-5-22></a>  <span class=n>TILE_N</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>tile_size</span><span class=o>.</span><span class=n>gemm_moving_fmax</span>  <span class=c1># 512</span>
<a href=#__codelineno-5-23 id=__codelineno-5-23 name=__codelineno-5-23></a>
<a href=#__codelineno-5-24 id=__codelineno-5-24 name=__codelineno-5-24></a>  <span class=n>BLOCK_M</span> <span class=o>=</span> <span class=n>TILE_M</span> <span class=o>*</span> <span class=n>TILES_IN_BLOCK_M</span>
<a href=#__codelineno-5-25 id=__codelineno-5-25 name=__codelineno-5-25></a>  <span class=n>BLOCK_N</span> <span class=o>=</span> <span class=n>TILE_N</span> <span class=o>*</span> <span class=n>TILES_IN_BLOCK_N</span>
<a href=#__codelineno-5-26 id=__codelineno-5-26 name=__codelineno-5-26></a>  <span class=n>BLOCK_K</span> <span class=o>=</span> <span class=n>TILE_K</span> <span class=o>*</span> <span class=n>TILES_IN_BLOCK_K</span>
<a href=#__codelineno-5-27 id=__codelineno-5-27 name=__codelineno-5-27></a>
<a href=#__codelineno-5-28 id=__codelineno-5-28 name=__codelineno-5-28></a>  <span class=c1># the size has to be multiple of block size</span>
<a href=#__codelineno-5-29 id=__codelineno-5-29 name=__codelineno-5-29></a>  <span class=c1># nl indexing cannot handle out of bound indexing</span>
<a href=#__codelineno-5-30 id=__codelineno-5-30 name=__codelineno-5-30></a>  <span class=k>assert</span> <span class=n>M</span> <span class=o>%</span> <span class=n>BLOCK_M</span> <span class=o>==</span> <span class=mi>0</span>
<a href=#__codelineno-5-31 id=__codelineno-5-31 name=__codelineno-5-31></a>  <span class=k>assert</span> <span class=n>N</span> <span class=o>%</span> <span class=n>BLOCK_N</span> <span class=o>==</span> <span class=mi>0</span>
<a href=#__codelineno-5-32 id=__codelineno-5-32 name=__codelineno-5-32></a>  <span class=k>assert</span> <span class=n>K</span> <span class=o>%</span> <span class=n>BLOCK_K</span> <span class=o>==</span> <span class=mi>0</span>
<a href=#__codelineno-5-33 id=__codelineno-5-33 name=__codelineno-5-33></a>
<a href=#__codelineno-5-34 id=__codelineno-5-34 name=__codelineno-5-34></a>  <span class=n>NUM_BLOCK_M</span> <span class=o>=</span> <span class=n>M</span> <span class=o>//</span> <span class=n>BLOCK_M</span>
<a href=#__codelineno-5-35 id=__codelineno-5-35 name=__codelineno-5-35></a>  <span class=n>NUM_BLOCK_N</span> <span class=o>=</span> <span class=n>N</span> <span class=o>//</span> <span class=n>BLOCK_N</span>
<a href=#__codelineno-5-36 id=__codelineno-5-36 name=__codelineno-5-36></a>  <span class=n>NUM_BLOCK_K</span> <span class=o>=</span> <span class=n>K</span> <span class=o>//</span> <span class=n>BLOCK_K</span>
<a href=#__codelineno-5-37 id=__codelineno-5-37 name=__codelineno-5-37></a>
<a href=#__codelineno-5-38 id=__codelineno-5-38 name=__codelineno-5-38></a>  <span class=c1># Blocking N dimension (the RHS free dimension)</span>
<a href=#__codelineno-5-39 id=__codelineno-5-39 name=__codelineno-5-39></a>  <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=n>nl</span><span class=o>.</span><span class=n>affine_range</span><span class=p>(</span><span class=n>NUM_BLOCK_N</span><span class=p>):</span>
<a href=#__codelineno-5-40 id=__codelineno-5-40 name=__codelineno-5-40></a>    <span class=n>result_tiles</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>NUM_BLOCK_M</span><span class=p>,</span> <span class=n>TILES_IN_BLOCK_M</span><span class=p>,</span> <span class=n>TILES_IN_BLOCK_N</span><span class=p>,</span>
<a href=#__codelineno-5-41 id=__codelineno-5-41 name=__codelineno-5-41></a>                             <span class=n>nl</span><span class=o>.</span><span class=n>par_dim</span><span class=p>(</span><span class=n>TILE_M</span><span class=p>),</span> <span class=n>TILE_N</span><span class=p>),</span>
<a href=#__codelineno-5-42 id=__codelineno-5-42 name=__codelineno-5-42></a>                            <span class=n>dtype</span><span class=o>=</span><span class=n>lhsT</span><span class=o>.</span><span class=n>dtype</span><span class=p>,</span>
<a href=#__codelineno-5-43 id=__codelineno-5-43 name=__codelineno-5-43></a>                            <span class=n>buffer</span><span class=o>=</span><span class=n>nl</span><span class=o>.</span><span class=n>sbuf</span><span class=p>)</span>
<a href=#__codelineno-5-44 id=__codelineno-5-44 name=__codelineno-5-44></a>
<a href=#__codelineno-5-45 id=__codelineno-5-45 name=__codelineno-5-45></a>    <span class=c1># Blocking K dimension (the contraction dimension)</span>
<a href=#__codelineno-5-46 id=__codelineno-5-46 name=__codelineno-5-46></a>    <span class=c1># Use `sequential_range` because we do not want the compiler to change this loop by, </span>
<a href=#__codelineno-5-47 id=__codelineno-5-47 name=__codelineno-5-47></a>    <span class=c1># for example, vectorizing it</span>
<a href=#__codelineno-5-48 id=__codelineno-5-48 name=__codelineno-5-48></a>    <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=n>nl</span><span class=o>.</span><span class=n>sequential_range</span><span class=p>(</span><span class=n>NUM_BLOCK_K</span><span class=p>):</span>
<a href=#__codelineno-5-49 id=__codelineno-5-49 name=__codelineno-5-49></a>      <span class=c1># Loading tiles from rhs</span>
<a href=#__codelineno-5-50 id=__codelineno-5-50 name=__codelineno-5-50></a>      <span class=c1># setting the load tile to `TILE_K x BLOCK_SIZE_N` to optimize DMA performance</span>
<a href=#__codelineno-5-51 id=__codelineno-5-51 name=__codelineno-5-51></a>      <span class=n>i_rhs</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>mgrid</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=n>TILE_K</span><span class=p>,</span> <span class=mi>0</span><span class=p>:</span><span class=n>BLOCK_N</span><span class=p>]</span>
<a href=#__codelineno-5-52 id=__codelineno-5-52 name=__codelineno-5-52></a>      <span class=n>rhs_tiles</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>ndarray</span><span class=p>((</span><span class=n>TILES_IN_BLOCK_K</span><span class=p>,</span> <span class=n>nl</span><span class=o>.</span><span class=n>par_dim</span><span class=p>(</span><span class=n>TILE_K</span><span class=p>),</span> <span class=n>BLOCK_N</span><span class=p>),</span>
<a href=#__codelineno-5-53 id=__codelineno-5-53 name=__codelineno-5-53></a>                             <span class=n>dtype</span><span class=o>=</span><span class=n>rhs</span><span class=o>.</span><span class=n>dtype</span><span class=p>,</span>
<a href=#__codelineno-5-54 id=__codelineno-5-54 name=__codelineno-5-54></a>                             <span class=n>buffer</span><span class=o>=</span><span class=n>nl</span><span class=o>.</span><span class=n>sbuf</span><span class=p>)</span>
<a href=#__codelineno-5-55 id=__codelineno-5-55 name=__codelineno-5-55></a>
<a href=#__codelineno-5-56 id=__codelineno-5-56 name=__codelineno-5-56></a>      <span class=k>for</span> <span class=n>bk_r</span> <span class=ow>in</span> <span class=n>nl</span><span class=o>.</span><span class=n>affine_range</span><span class=p>(</span><span class=n>TILES_IN_BLOCK_K</span><span class=p>):</span>
<a href=#__codelineno-5-57 id=__codelineno-5-57 name=__codelineno-5-57></a>        <span class=n>rhs_tiles</span><span class=p>[</span><span class=n>bk_r</span><span class=p>,</span> <span class=n>i_rhs</span><span class=o>.</span><span class=n>p</span><span class=p>,</span> <span class=n>i_rhs</span><span class=o>.</span><span class=n>x</span><span class=p>]</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>load</span><span class=p>(</span>
<a href=#__codelineno-5-58 id=__codelineno-5-58 name=__codelineno-5-58></a>            <span class=n>rhs</span><span class=p>[(</span><span class=n>TILES_IN_BLOCK_K</span> <span class=o>*</span> <span class=n>k</span> <span class=o>+</span> <span class=n>bk_r</span><span class=p>)</span> <span class=o>*</span> <span class=n>TILE_K</span> <span class=o>+</span> <span class=n>i_rhs</span><span class=o>.</span><span class=n>p</span><span class=p>,</span>
<a href=#__codelineno-5-59 id=__codelineno-5-59 name=__codelineno-5-59></a>                <span class=n>BLOCK_N</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>i_rhs</span><span class=o>.</span><span class=n>x</span><span class=p>])</span>
<a href=#__codelineno-5-60 id=__codelineno-5-60 name=__codelineno-5-60></a>
<a href=#__codelineno-5-61 id=__codelineno-5-61 name=__codelineno-5-61></a>      <span class=c1># Blocking M dimension (the LHS free dimension)</span>
<a href=#__codelineno-5-62 id=__codelineno-5-62 name=__codelineno-5-62></a>      <span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>nl</span><span class=o>.</span><span class=n>affine_range</span><span class=p>(</span><span class=n>NUM_BLOCK_M</span><span class=p>):</span>
<a href=#__codelineno-5-63 id=__codelineno-5-63 name=__codelineno-5-63></a>        <span class=c1># Loading tiles from lhsT</span>
<a href=#__codelineno-5-64 id=__codelineno-5-64 name=__codelineno-5-64></a>        <span class=n>i_lhsT</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>mgrid</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=n>TILE_K</span><span class=p>,</span> <span class=mi>0</span><span class=p>:</span><span class=n>BLOCK_M</span><span class=p>]</span>
<a href=#__codelineno-5-65 id=__codelineno-5-65 name=__codelineno-5-65></a>        <span class=n>lhsT_tiles</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>ndarray</span><span class=p>((</span><span class=n>TILES_IN_BLOCK_K</span><span class=p>,</span> <span class=n>nl</span><span class=o>.</span><span class=n>par_dim</span><span class=p>(</span><span class=n>TILE_K</span><span class=p>),</span> <span class=n>BLOCK_M</span><span class=p>),</span>
<a href=#__codelineno-5-66 id=__codelineno-5-66 name=__codelineno-5-66></a>                                <span class=n>dtype</span><span class=o>=</span><span class=n>lhsT</span><span class=o>.</span><span class=n>dtype</span><span class=p>,</span>
<a href=#__codelineno-5-67 id=__codelineno-5-67 name=__codelineno-5-67></a>                                <span class=n>buffer</span><span class=o>=</span><span class=n>nl</span><span class=o>.</span><span class=n>sbuf</span><span class=p>)</span>
<a href=#__codelineno-5-68 id=__codelineno-5-68 name=__codelineno-5-68></a>        <span class=k>for</span> <span class=n>bk_l</span> <span class=ow>in</span> <span class=n>nl</span><span class=o>.</span><span class=n>affine_range</span><span class=p>(</span><span class=n>TILES_IN_BLOCK_K</span><span class=p>):</span>
<a href=#__codelineno-5-69 id=__codelineno-5-69 name=__codelineno-5-69></a>          <span class=n>lhsT_tiles</span><span class=p>[</span><span class=n>bk_l</span><span class=p>,</span> <span class=n>i_lhsT</span><span class=o>.</span><span class=n>p</span><span class=p>,</span> <span class=n>i_lhsT</span><span class=o>.</span><span class=n>x</span><span class=p>]</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>load</span><span class=p>(</span>
<a href=#__codelineno-5-70 id=__codelineno-5-70 name=__codelineno-5-70></a>              <span class=n>lhsT</span><span class=p>[(</span><span class=n>TILES_IN_BLOCK_K</span> <span class=o>*</span> <span class=n>k</span> <span class=o>+</span> <span class=n>bk_l</span><span class=p>)</span> <span class=o>*</span> <span class=n>TILE_K</span> <span class=o>+</span> <span class=n>i_lhsT</span><span class=o>.</span><span class=n>p</span><span class=p>,</span>
<a href=#__codelineno-5-71 id=__codelineno-5-71 name=__codelineno-5-71></a>                   <span class=n>BLOCK_M</span> <span class=o>*</span> <span class=n>m</span> <span class=o>+</span> <span class=n>i_lhsT</span><span class=o>.</span><span class=n>x</span><span class=p>])</span>
<a href=#__codelineno-5-72 id=__codelineno-5-72 name=__codelineno-5-72></a>
<a href=#__codelineno-5-73 id=__codelineno-5-73 name=__codelineno-5-73></a>        <span class=c1># Do matmul with all tiles in the blocks</span>
<a href=#__codelineno-5-74 id=__codelineno-5-74 name=__codelineno-5-74></a>        <span class=n>i_lhsT_mm</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>mgrid</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=n>TILE_K</span><span class=p>,</span> <span class=mi>0</span><span class=p>:</span><span class=n>TILE_M</span><span class=p>]</span>
<a href=#__codelineno-5-75 id=__codelineno-5-75 name=__codelineno-5-75></a>        <span class=n>i_rhs_mm</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>mgrid</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=n>TILE_K</span><span class=p>,</span> <span class=mi>0</span><span class=p>:</span><span class=n>TILE_N</span><span class=p>]</span>
<a href=#__codelineno-5-76 id=__codelineno-5-76 name=__codelineno-5-76></a>        <span class=n>i_res_mm</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>mgrid</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=n>TILE_M</span><span class=p>,</span> <span class=mi>0</span><span class=p>:</span><span class=n>TILE_N</span><span class=p>]</span>
<a href=#__codelineno-5-77 id=__codelineno-5-77 name=__codelineno-5-77></a>        <span class=k>for</span> <span class=n>bn</span> <span class=ow>in</span> <span class=n>nl</span><span class=o>.</span><span class=n>affine_range</span><span class=p>(</span><span class=n>TILES_IN_BLOCK_N</span><span class=p>):</span>
<a href=#__codelineno-5-78 id=__codelineno-5-78 name=__codelineno-5-78></a>          <span class=k>for</span> <span class=n>bm</span> <span class=ow>in</span> <span class=n>nl</span><span class=o>.</span><span class=n>affine_range</span><span class=p>(</span><span class=n>TILES_IN_BLOCK_M</span><span class=p>):</span>
<a href=#__codelineno-5-79 id=__codelineno-5-79 name=__codelineno-5-79></a>            <span class=n>res_tile</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>TILE_M</span><span class=p>,</span> <span class=n>TILE_N</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>nl</span><span class=o>.</span><span class=n>float32</span><span class=p>,</span> <span class=n>buffer</span><span class=o>=</span><span class=n>nl</span><span class=o>.</span><span class=n>psum</span><span class=p>)</span>
<a href=#__codelineno-5-80 id=__codelineno-5-80 name=__codelineno-5-80></a>
<a href=#__codelineno-5-81 id=__codelineno-5-81 name=__codelineno-5-81></a>            <span class=k>for</span> <span class=n>bk</span> <span class=ow>in</span> <span class=n>nl</span><span class=o>.</span><span class=n>affine_range</span><span class=p>(</span><span class=n>TILES_IN_BLOCK_K</span><span class=p>):</span>
<a href=#__codelineno-5-82 id=__codelineno-5-82 name=__codelineno-5-82></a>              <span class=n>res_tile</span><span class=p>[</span><span class=o>...</span><span class=p>]</span> <span class=o>+=</span> <span class=n>nisa</span><span class=o>.</span><span class=n>nc_matmul</span><span class=p>(</span>
<a href=#__codelineno-5-83 id=__codelineno-5-83 name=__codelineno-5-83></a>                  <span class=n>lhsT_tiles</span><span class=p>[</span><span class=n>bk</span><span class=p>,</span> <span class=n>i_lhsT_mm</span><span class=o>.</span><span class=n>p</span><span class=p>,</span> <span class=n>bm</span> <span class=o>*</span> <span class=n>TILE_M</span> <span class=o>+</span> <span class=n>i_lhsT_mm</span><span class=o>.</span><span class=n>x</span><span class=p>],</span>
<a href=#__codelineno-5-84 id=__codelineno-5-84 name=__codelineno-5-84></a>                  <span class=n>rhs_tiles</span><span class=p>[</span><span class=n>bk</span><span class=p>,</span> <span class=n>i_rhs_mm</span><span class=o>.</span><span class=n>p</span><span class=p>,</span> <span class=n>bn</span> <span class=o>*</span> <span class=n>TILE_N</span> <span class=o>+</span> <span class=n>i_rhs_mm</span><span class=o>.</span><span class=n>x</span><span class=p>])</span>
<a href=#__codelineno-5-85 id=__codelineno-5-85 name=__codelineno-5-85></a>
<a href=#__codelineno-5-86 id=__codelineno-5-86 name=__codelineno-5-86></a>            <span class=c1># Accumulate on corresponding SBUF tile</span>
<a href=#__codelineno-5-87 id=__codelineno-5-87 name=__codelineno-5-87></a>            <span class=n>result_tiles</span><span class=p>[</span><span class=n>m</span><span class=p>,</span> <span class=n>bm</span><span class=p>,</span> <span class=n>bn</span><span class=p>,</span> <span class=n>i_res_mm</span><span class=o>.</span><span class=n>p</span><span class=p>,</span>
<a href=#__codelineno-5-88 id=__codelineno-5-88 name=__codelineno-5-88></a>                         <span class=n>i_res_mm</span><span class=o>.</span><span class=n>x</span><span class=p>]</span> <span class=o>+=</span> <span class=n>res_tile</span><span class=p>[</span><span class=n>i_res_mm</span><span class=o>.</span><span class=n>p</span><span class=p>,</span> <span class=n>i_res_mm</span><span class=o>.</span><span class=n>x</span><span class=p>]</span>
<a href=#__codelineno-5-89 id=__codelineno-5-89 name=__codelineno-5-89></a>
<a href=#__codelineno-5-90 id=__codelineno-5-90 name=__codelineno-5-90></a>    <span class=c1># Copying the result from SBUF to HBM</span>
<a href=#__codelineno-5-91 id=__codelineno-5-91 name=__codelineno-5-91></a>    <span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>nl</span><span class=o>.</span><span class=n>affine_range</span><span class=p>(</span><span class=n>NUM_BLOCK_M</span><span class=p>):</span>
<a href=#__codelineno-5-92 id=__codelineno-5-92 name=__codelineno-5-92></a>      <span class=k>for</span> <span class=n>bm</span> <span class=ow>in</span> <span class=n>nl</span><span class=o>.</span><span class=n>affine_range</span><span class=p>(</span><span class=n>TILES_IN_BLOCK_M</span><span class=p>):</span>
<a href=#__codelineno-5-93 id=__codelineno-5-93 name=__codelineno-5-93></a>        <span class=n>i_res</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>mgrid</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=n>TILE_K</span><span class=p>,</span> <span class=mi>0</span><span class=p>:</span><span class=n>TILE_N</span><span class=p>]</span>
<a href=#__codelineno-5-94 id=__codelineno-5-94 name=__codelineno-5-94></a>        <span class=n>i_res_packed</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>mgrid</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=n>TILE_K</span><span class=p>,</span> <span class=mi>0</span><span class=p>:</span><span class=n>BLOCK_N</span><span class=p>]</span>
<a href=#__codelineno-5-95 id=__codelineno-5-95 name=__codelineno-5-95></a>        <span class=n>result_packed</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>ndarray</span><span class=p>((</span><span class=n>TILE_K</span><span class=p>,</span> <span class=n>BLOCK_N</span><span class=p>),</span>
<a href=#__codelineno-5-96 id=__codelineno-5-96 name=__codelineno-5-96></a>                                   <span class=n>dtype</span><span class=o>=</span><span class=n>result_tiles</span><span class=o>.</span><span class=n>dtype</span><span class=p>,</span>
<a href=#__codelineno-5-97 id=__codelineno-5-97 name=__codelineno-5-97></a>                                   <span class=n>buffer</span><span class=o>=</span><span class=n>nl</span><span class=o>.</span><span class=n>sbuf</span><span class=p>)</span>
<a href=#__codelineno-5-98 id=__codelineno-5-98 name=__codelineno-5-98></a>
<a href=#__codelineno-5-99 id=__codelineno-5-99 name=__codelineno-5-99></a>        <span class=c1># coalesce result tiles for better DMA performance</span>
<a href=#__codelineno-5-100 id=__codelineno-5-100 name=__codelineno-5-100></a>        <span class=k>for</span> <span class=n>bn</span> <span class=ow>in</span> <span class=n>nl</span><span class=o>.</span><span class=n>affine_range</span><span class=p>(</span><span class=n>TILES_IN_BLOCK_N</span><span class=p>):</span>
<a href=#__codelineno-5-101 id=__codelineno-5-101 name=__codelineno-5-101></a>          <span class=n>result_packed</span><span class=p>[</span><span class=n>i_res</span><span class=o>.</span><span class=n>p</span><span class=p>,</span>
<a href=#__codelineno-5-102 id=__codelineno-5-102 name=__codelineno-5-102></a>                        <span class=n>bn</span> <span class=o>*</span> <span class=n>TILE_N</span> <span class=o>+</span> <span class=n>i_res</span><span class=o>.</span><span class=n>x</span><span class=p>]</span> <span class=o>=</span> <span class=n>nl</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=n>result_tiles</span><span class=p>[</span><span class=n>m</span><span class=p>,</span> <span class=n>bm</span><span class=p>,</span> <span class=n>bn</span><span class=p>,</span>
<a href=#__codelineno-5-103 id=__codelineno-5-103 name=__codelineno-5-103></a>                                                                      <span class=n>i_res</span><span class=o>.</span><span class=n>p</span><span class=p>,</span>
<a href=#__codelineno-5-104 id=__codelineno-5-104 name=__codelineno-5-104></a>                                                                      <span class=n>i_res</span><span class=o>.</span><span class=n>x</span><span class=p>])</span>
<a href=#__codelineno-5-105 id=__codelineno-5-105 name=__codelineno-5-105></a>        <span class=n>nl</span><span class=o>.</span><span class=n>store</span><span class=p>(</span><span class=n>result</span><span class=p>[(</span><span class=n>TILES_IN_BLOCK_M</span> <span class=o>*</span> <span class=n>m</span> <span class=o>+</span> <span class=n>bm</span><span class=p>)</span> <span class=o>*</span> <span class=n>TILE_K</span> <span class=o>+</span> <span class=n>i_res_packed</span><span class=o>.</span><span class=n>p</span><span class=p>,</span>
<a href=#__codelineno-5-106 id=__codelineno-5-106 name=__codelineno-5-106></a>                        <span class=n>BLOCK_N</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>i_res_packed</span><span class=o>.</span><span class=n>x</span><span class=p>],</span>
<a href=#__codelineno-5-107 id=__codelineno-5-107 name=__codelineno-5-107></a>                 <span class=n>value</span><span class=o>=</span><span class=n>result_packed</span><span class=p>[</span><span class=n>i_res_packed</span><span class=o>.</span><span class=n>p</span><span class=p>,</span> <span class=n>i_res_packed</span><span class=o>.</span><span class=n>x</span><span class=p>])</span>
<a href=#__codelineno-5-108 id=__codelineno-5-108 name=__codelineno-5-108></a>
<a href=#__codelineno-5-109 id=__codelineno-5-109 name=__codelineno-5-109></a>  <span class=k>return</span> <span class=n>result</span>
</code></pre></div> </details> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">December 13, 2024</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">December 6, 2024</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2017 - 2024 | Haoda Li </div> </div> <div class=md-social> <a href=https://www.linkedin.com/in/haoda-li-515b26165/ target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href=https://github.com/haoda-li/ target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href="https://scholar.google.com/citations?user=e1Bif78AAAAJ" target=_blank rel=noopener title=scholar.google.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 488 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.tabs", "navigation.top"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.83f73b43.min.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../assets/extra.js></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>